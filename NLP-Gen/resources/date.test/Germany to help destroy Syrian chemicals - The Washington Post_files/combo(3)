if(window.XDomainRequest){jQuery.ajaxTransport(function(B){if(B.crossDomain&&B.async){if(B.timeout){B.xdrTimeout=B.timeout;delete B.timeout;}var A;return{send:function(D,C){function E(F,I,H,G){A.onload=A.onerror=A.ontimeout=jQuery.noop;A=undefined;C(F,I,H,G);}A=new XDomainRequest();A.onload=function(){E(200,"OK",{text:A.responseText},"Content-Type: "+A.contentType);};A.onerror=function(){E(404,"Not Found");};A.onprogress=jQuery.noop;A.ontimeout=function(){E(0,"timeout");};A.timeout=B.xdrTimeout||Number.MAX_VALUE;A.open(B.type,B.url);A.send((B.hasContent&&B.data)||null);},abort:function(){if(A){A.onerror=jQuery.noop;A.abort();}}};}});}(function(A){TWP=TWP||{};TWP.Util=TWP.Util||{};TWP.Util.Ajax=TWP.Util.Ajax||{};TWP.Util.Ajax.rescan=function(C){if(typeof TWP.jsConfig=="object"&&typeof TWP.jsConfig.initFunctions=="object"){for(var B=0;B<TWP.jsConfig.initFunctions.length;B++){TWP.jsConfig.initFunctions[B](C);}}if(typeof CJS=="object"){C.each(function(D,E){CJS.rescan(E);});}if(typeof A.fn.imageLazyLoader=="function"){C.find(".unloaded").imageLazyLoader();}};TWP.Util.Ajax.moduleRequest=function(D,B,M){var F=A.extend({refresh:true,refreshEl:undefined,refreshInterval:60,preserveDimensions:false,callback:undefined},M);var J=TWP.Util.Ajax.isCrossDomain(B);var C=false;var H=A('<div class="wp-ajax-timer"></div>');var L=function(){if(F.refreshEl){F.refreshEl.append(H);}else{D.append(H);}};var E=function(){var O=Math.floor(countdown/60);var N=countdown-(O*60);N=(N<10?"0":"")+N;base.find(".time").html(O+":"+N);if(countdownDisabled){timestampDiv.remove();return ;}if(countdown>0){countdown--;msUntilNextSecond=(1000-(new Date().getTime()%1000));setTimeout(updateClock,msUntilNextSecond);}else{loadData();countdown=60;updateClock();}};var G=function(){D.removeClass("wp-ajax-loading");TWP.Util.Ajax.rescan(D);if(typeof F.refresh=="function"&&F.refresh(D)){setTimer();}if(!F.preserveDimensions){D.css({height:"",width:""});}if(typeof F.callback=="function"){F.callback();}};var I=function(){if(J){if(A.browser.msie&&window.XDomainRequest){var N=new XDomainRequest();N.open("get",B);N.onload=function(){D.html(N.responseText);G();};N.send();}else{if(A.browser.msie&&!window.XDomainRequest){A.getScript("/rw/sites/twpweb/js/plugin/xhr/flXHR.js",function(P,S,Q){window.flensed.base_path="/rw/sites/twpweb/js/plugin/xhr/";var R=new flensed.flXHR({autoUpdatePlayer:true});R.xmlResponseText=false;R.onreadystatechange=O;R.open("GET",B);R.send();function O(T){if(T.readyState==4){D.html(T.responseText);G();}}});}else{D.load(B,G);}}}else{D.load(B,G);}};var K=function(){I();};K();};TWP.Util.Ajax.isCrossDomain=function(C){var B=B=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/;var H=B.exec(C.toLowerCase())||false;var D="";try{D=location.href;}catch(G){D=document.createElement("a");D.href="";D=D.href;}var E=B.exec(D.toLowerCase())||[];var F=H&&(H.join(":")+(H[3]?"":H[1]==="http:"?80:443))!==(E.join(":")+(E[3]?"":E[1]==="http:"?80:443));return F;};TWP.Util.Ajax.replaceOnClick=function(D,C,B){TWP.Util.Ajax.placeContent(D,C,A.extend(B,{"target":D,"trigger":"click"}));};TWP.Util.Ajax.placeContent=function(C,B,O){var E=A.extend({target:C,trigger:"click",cache:false,prefetch:false,clearContent:false,callback:null},O);var D;var F=false;var I=false;if(typeof C!="object"||typeof E.target!="object"){return ;}var J=E.triggerOnBeacon||function(S){var R=S.beacon;var P=S.target;if(A(window).height()+A(window).scrollTop()>R.offset().top){var Q=setInterval(function(){P.trigger(S.trigger);if(P.children().size()>0){clearInterval(Q);}},200);}A(window).scroll(function(){if(!!R&&!!P){if(A(window).height()+A(window).scrollTop()>R.offset().top){P.trigger(S.trigger);}}});};if(typeof B!="string"){B=C.attr("data-url");E.prefetch=(C.attr("data-prefetch")=="true");E.cache=(C.attr("data-cache")=="true");E.useAutoload=(C.attr("data-use-autoload")=="true");E.beaconId=E.beaconId||(C.attr("data-beacon-id"));if(typeof B!="string"){return ;}}if(E.useAutoload){if(!!E.beaconId&&!E.beacon){E.beacon=A("#"+E.beaconId);}if(!E.beacon||!E.beacon.size()){E.beacon=E.target;}J(E);}var G=function(){A.ajax(B,{cache:E.cache,error:N,success:M});};var N=function(P,Q){};var M=function(Q,R,P){F=true;if(E.prefetch&&!I){D=Q;}else{H(Q);}};var H=function(P){E.target.empty();E.target.append(P);TWP.Util.Ajax.rescan(E.target);if(typeof E.callback=="function"){E.callback();}E.target.removeClass("loading");L();};var L=function(){var P=A(E.target.closest(".tabbed-panels")),V=A(E.target.closest(".tabbed-panels.bottom .panel-ajax-container")),R=V.children().last(".module, .grid, .package"),W=A(E.target.closest("div.panel"));if(!!W.size()){W.removeClass("unloaded");}if(!!R.size()){R.css("padding-bottom","0");R.css("border-bottom","none");R.css("margin-bottom","0");}if(!!window.TWP&&!!TWP.Modules&&!!TWP.Modules.setLargestHeight){var T=P.find(".panels"),Q=P.find("div.panels:eq(0)>div.panel"),S=P.find("div.panels:eq(0)>div.panel.unloaded").size(),U=P.find("div.panels-variable-length:eq(0)>div.panel");if(E.target.height()>0&&T.length>0&&U.length==0){TWP.Modules.setLargestHeight(Q,T);}}};var K=function(){if(E.prefetch){G();}var P=function(){E.target.addClass("loading");if(E.prefetch){if(F){H(D);}else{I=true;}}else{G();}};C.on(E.trigger,function(){if(!E.clearContent){C.unbind(E.trigger);P();}else{var Q=A(E.target.closest(".tabbed-panels"));if(A("."+A(C).attr("data-tab-title")).hasClass("unloaded")){P();A.each(Q.find(".light-tabs a"),function(S,W){var R=A(W);if(!R.hasClass("on")){var U=R.attr("data-tab-title");if(U){var V=Q.find("."+U);var T=V.children(".panel-ajax-container");T.children().remove();V.addClass("unloaded");}}});}else{return ;}}});C.find("a").removeAttr("href");};K();};})(jQuery);