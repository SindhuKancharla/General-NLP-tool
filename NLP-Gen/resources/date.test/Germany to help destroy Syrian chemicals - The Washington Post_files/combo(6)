(function(A){A.fn.twp_socialDisplay=function(C){var B=this;var E={feedName:"id_NH_primary",feedType:"echo-stream",numResults:"10",seo:true};var C=A.extend({},E,C);var F;var D;return B.each(function(N,J){Q();O(B);K(B);R();H(B);function M(U){if(A(".cards .card",U).length>0){var T=U.attr("data-feed-type");var Y=encodeURIComponent(U.attr("data-feed-name"));var V=U.attr("data-numresults");var X=U.attr("data-item-display-type");var W=U.attr("data-item-display-num");urlPath="/fragment/SysConfig/WebPortal/twpweb/modules/social/render.jpt?feedType="+T+"&feedName="+Y+"&numResults="+V+"&itemDisplayType="+X+"&itemDisplayNum="+W+"&socialFeed=true";jQuery.ajax({url:urlPath,dataType:"html",cache:true,context:U,success:function(Z){if(A(Z).find(".card .error").length==0){A(".cards",A(this)).replaceWith(Z);O(A(this));K(A(this));}}});}}function S(U,T){if(!U.find("img").attr("src")){U.find("img").attr("src",U.find("img").attr("data-src"));}if(!U.next(".card",T).find("img").attr("src")){U.next(".card",T).find("img").attr("src",U.next(".card").find("img").attr("data-src"));}A(".card",T).removeClass("current");U.addClass("current");K(T);}function O(T){A(".instagram-description",T).each(function(U){var V=A(this).html();if(V.length>140){V=V.substring(0,140)+"...";}A(this).html(V);});A(".card .date",T).each(function(U){A(this).html(P(parseInt(A(this).attr("data-time"))));});if(T.is(".feed-twitter")){TWP.Modules.setLargestHeight(A(".card"),A(".cards"));A(".card",T).css("display","");}}function Q(){A(".next",B).click(function(U){U.stopImmediatePropagation();clearInterval(F);var V=(isNaN(parseInt(B.attr("data-item-display-num"))))?1:parseInt(B.attr("data-item-display-num"));var T=A(".current",B).next(".card",B);if(T.length&&T.length>=V){S(T,B);}});A(".prev",B).click(function(U){U.stopImmediatePropagation();clearInterval(F);var V=(isNaN(parseInt(B.attr("data-item-display-num"))))?1:parseInt(B.attr("data-item-display-num"));var T=A(".current",B).prev(".card",B);if(T.length&&T.length>=V){S(T,B);}});A(B).mouseenter(function(){I();});A(B).mouseleave(function(){R();});}function K(U){var T=A(".current",U);var W=A(".current",U).first().prev(".card",U);var V=A(".current",U).last().next(".card",U);if(W.length){A(".prev .btn",U).show();}else{A(".prev .btn",U).hide();}if(V.length){A(".next .btn",U).show();}else{A(".next .btn",U).hide();}}function G(){var U=(isNaN(parseInt(B.attr("data-item-display-num"))))?1:parseInt(B.attr("data-item-display-num"));var T=A(".current",B).next(".card",B);if(T.length&&T.length>=U){S(T,B);}else{S(A(".card",B).slice(0,U),B);}}function R(){clearInterval(F);F=setInterval(G,10000);}function H(T){clearInterval(D);D=setInterval(function(){M(T);},120000);}function I(){clearInterval(F);}function L(){R();}function P(Z){var b=new Date();var X=new Date(Z);var a=b-X;var U=1000,V=U*60,W=V*60,Y=W*24,T=Y*7;if(isNaN(a)||a<0){return"right now";}if(a<U*2){return"right now";}if(a<V){return"about "+Math.floor(a/U)+"s ago";}if(a<V*2){return"about a min ago";}if(a<W){return"about "+Math.floor(a/V)+"m ago";}if(a<W*2){return"about an hour ago";}if(a<Y){return"about "+Math.floor(a/W)+"h ago";}if(a<Y*365){return Math.floor(a/Y)+"d ago";}else{return"over a year ago";}}});};})(jQuery);