
/* comments.js 1637517 */ YUI.add("media-comments",function(a){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};if(typeof(YAHOO)=="undefined"){YAHOO={}}a.namespace("Media");a.Media.UGCComments=function(b){this.init(b)};a.Media.UGCComments.prototype={ioState:0,bubbleCmtId:"",context_id:"",context_url:"",reValidateCrumb:false,sPostingDisabled:false,sUserImage:"",sUserNickname:"",sUserJurisdiction:"",oUserLocation:{},oOverlayContainer:[],aUgcCommentText:[],sCurrentSortBy:"",sCurrentFltrBy:"",sFltrCity:"",user_guid:"",oHideErrorOverlay:null,timeSpentTimer:0,timerStart:0,timeTracker:0,bConversations:false,disClosureLoader:"false",logOutRateVal:"",disclosureLoadLast:0,oInlineLoginCheckHandler:null,oLoginWindow:null,yMediaTracking:null,loginStatus:"inactive",xhrUrlQueue:[],unhide_comments_link:{show_comments:'<p class="ugccmt-stream-reload-msg"><a href="{LINK_NO_PHARMA_AD}">{CLICK_TO_VIEW_COMMENTS}</a></p>'},conv_link_templates:{start_conversation:'<p class="ugccmt-start-conv"><b class="ugccmt-new-lable">{NEW_LABLE} </b><a class="ugccmt-start-conv-link" href="#comments">{MSG_START_CONVERSATION}</a></p>'},aXHR:{GET_LIST:"/_xhr/ugccomments/?method=get_list",ERR_LOG:"/_xhr/ugccomments/?method=log_jserror",POST_COMMENT:"/_xhr/ugccomments/?method=post_comment",POST_REPLY:"/_xhr/ugccomments/?method=post_reply",DELETE_COMMENT:"/_xhr/ugccomments/?method=delete_comment",DELETE_REPLY:"/_xhr/ugccomments/?method=delete_reply",RATE_COMMENT:"/_xhr/ugccomments/?method=rate_comment",RATE_REPLY:"/_xhr/ugccomments/?method=rate_reply",REPORT_ABUSE_COMMENT:"/_xhr/ugccomments/?method=report_abuse_comment",REPORT_ABUSE_REPLY:"/_xhr/ugccomments/?method=report_abuse_reply",GET_DISCLOSURE:"/_xhr/ugccomments/?method=get_disclosure",LOGIN:"/_xhr/ugccomments_login/?method=login",GET_CONTEXT_UUID:"/_xhr/ugccomments/?method=get_context_uuid",UPDATE_STATUS:"/_xhr/ugccomments/?method=update_status",GET_USER_CMT:"/_xhr/ugccomments/?method=user_comments",GET_USER_ACTV:"/_xhr/ugccomments/?method=user_activity",CHECK_STATUS:"/_xhr/ugccomments/?method=check_status",USER_RATINGS:"/_xhr/ugccomments/?method=user_ratings",REVOKE_BADGE:"/_xhr/ugccomments/?method=revoke_badge"},init:function(p){var o=this;for(var r in p){if(p.hasOwnProperty(r)){this[r]=p[r]}}var f=document.location.search;f=f.substring(1);var l=a.QueryString.parse(f);this.tracking.vsource="";this.tracking_vreason="";this.aXHR.ERR_LOG+=this.bucket_publisher_id_url+"&err_code=";if(o.oOverlayContainer&&o.oOverlayContainer.logout){o.oOverlayContainer.logout=null}if(typeof l.bcmt!="undefined"&&l.bcmt!==""){var s=l.bcmt.split("_");if(typeof s[1]!="undefined"){this.tracking_vreason="reply"}else{this.tracking_vreason="comment"}}if(("ads_supp_ugc" in YUI.namespace("Media"))&&(YUI.namespace("Media").ads_supp_ugc==1)){this.removeCommentStream();return}if(typeof l.bcmt_s!="undefined"&&l.bcmt_s!==""){this.tracking.vsource=l.bcmt_s;if(typeof l.ra!="undefined"&&l.ra=="1"){this.tracking_vreason+="_abuse"}}else{if(typeof l.bcmt!="undefined"&&l.bcmt!==""){this.tracking.vsource="v"}}var e="";if(typeof l["_media.modules.comments.switches._enable_top_contributor"]!="undefined"){e+="&_media.modules.comments.switches._enable_top_contributor=";e+=(l["_media.modules.comments.switches._enable_top_contributor"]=="1")?"1":"0";for(var m in this.aXHR){this.aXHR[m]+=e}}if(typeof l["_media.modules.comments.switches._enable_location"]!="undefined"){var c="&_media.modules.comments.switches._enable_location=";c+=(l["_media.modules.comments.switches._enable_location"]=="1")?"1":"0";this.aXHR={GET_LIST:"/_xhr/ugccomments/?method=get_list"+c,ERR_LOG:"/_xhr/ugccomments/?method=log_jserror&err_code="+c,POST_COMMENT:"/_xhr/ugccomments/?method=post_comment"+c,POST_REPLY:"/_xhr/ugccomments/?method=post_reply"+c,DELETE_COMMENT:"/_xhr/ugccomments/?method=delete_comment"+c,DELETE_REPLY:"/_xhr/ugccomments/?method=delete_reply"+c,RATE_COMMENT:"/_xhr/ugccomments/?method=rate_comment"+c,RATE_REPLY:"/_xhr/ugccomments/?method=rate_reply"+c,REPORT_ABUSE_COMMENT:"/_xhr/ugccomments/?method=report_abuse_comment"+c,REPORT_ABUSE_REPLY:"/_xhr/ugccomments/?method=report_abuse_reply"+c,GET_DISCLOSURE:"/_xhr/ugccomments/?method=get_disclosure"+c,LOGIN:"/_xhr/ugccomments_login/?method=login"+c,GET_CONTEXT_UUID:"/_xhr/ugccomments/?method=get_context_uuid"+c,GET_USER_CMT:"/_xhr/ugccomments/?method=user_comments"+c,GET_USER_ACTV:"/_xhr/ugccomments/?method=user_activity"+c,UPDATE_STATUS:"/_xhr/ugccomments/?method=update_status"+c,USER_RATINGS:"/_xhr/ugccomments/?method=user_ratings"+c}}if(typeof l["_media.modules.comments.switches._enable_topic_cloud"]!="undefined"){var q="&_media.modules.comments.switches._enable_topic_cloud=";q+=(l["_media.modules.comments.switches._enable_topic_cloud"]=="1")?"1":"0";this.aXHR.GET_LIST=this.aXHR.GET_LIST+q;this.aXHR.POST_COMMENT=this.aXHR.POST_COMMENT+q;this.aXHR.POST_REPLY=this.aXHR.POST_REPLY+q;this.aXHR.DELETE_COMMENT=this.aXHR.DELETE_COMMENT+q;this.aXHR.DELETE_REPLY=this.aXHR.DELETE_REPLY+q;this.aXHR.RATE_COMMENT=this.aXHR.RATE_COMMENT+q;this.aXHR.RATE_REPLY=this.aXHR.RATE_REPLY+q;this.aXHR.REPORT_ABUSE_COMMENT=this.aXHR.REPORT_ABUSE_COMMENT+q;this.aXHR.REPORT_ABUSE_REPLY=this.aXHR.REPORT_ABUSE_REPLY+q;this.aXHR.GET_DISCLOSURE=this.aXHR.GET_DISCLOSURE+q;this.aXHR.LOGIN=this.aXHR.LOGIN+q;this.aXHR.GET_CONTEXT_UUID=this.aXHR.GET_CONTEXT_UUID+q;this.aXHR.GET_USER_CMT=this.aXHR.GET_USER_CMT+q;this.aXHR.GET_USER_ACTV=this.aXHR.GET_USER_ACTV+q;this.aXHR.UPDATE_STATUS=this.aXHR.UPDATE_STATUS+q;this.aXHR.USER_RATINGS=this.aXHR.USER_RATINGS+q}if(!a.Lang.isNull(a.one("#ugccmt-container-b"))){var k=a.one("#ugccmt-container-b div.ugccmt-flyw-trg");if(!a.Lang.isNull(k)){this.bubbleCmtId=k.get("parentNode").get("id")}document.location.href="#mediacommentsugc_container";this.renderPostFormMarkup(a.one("#ugccmt-container-b div.ugccmt-post-frm"));this.renderReplyLinks("ugccmt-container-b");this.renderRateButton("ugccmt-container-b");this.renderEllipSizedBox("ugccmt-container-b");this.ult_track("flw_load",a.one("#yom-comments"))}else{if(!a.Lang.isNull(a.one("#ugccmt-container"))){this.renderPostFormMarkup(a.one("#ugccmt-post-frm-container"));this.renderReplyLinks("ugccmt-container");this.renderRateButton("ugccmt-container");this.renderEllipSizedBox("ugccmt-container")}}this.renderMyProfile();if(!a.Lang.isNull(a.one("#ugccmt-container"))){a.on("scroll",this.scrollCalc,window,this,{custobj:a.one("#yom-comments")});this.checkCommentsInViewPort({custobj:a.one("#yom-comments")})}a.on("io:end",function(i){o.ioState=0},a);a.on("click",this.commentsClickListner,"#yom-comments",this,true);a.log("[MediaCommentsUgc]click subscription of #yom-comments","debug");var o=this;a.all(".ugccmt-show-reply-form").each(function(v){var t=v._node.id.split("_")[1];var i=a.one("#ugccmt-post-frm-container_"+t);o.renderPostFormMarkup(i);var u=a.one("#ugccmt-post-frm_"+t);if(!a.Lang.isNull(u)&&!a.Lang.isNull(u)){a.on("submit",o.commentsPostSubmitListner,u,o,true)}});a.all(".ugccmt-view-reply-form").each(function(i){if(!a.Lang.isNull(i)){a.on("click",o.renderReplyPostFormMarkup,i,o,true)}});a.all("#ugccmt-reply-form form").each(function(t){var i=t.one("textarea");if(!a.Lang.isNull(t)&&!a.Lang.isNull(i)){a.on("submit",o.commentsPostSubmitListner,t,o,true);a.on("keydown",o.commentsPostKeyListner,i,o,true);a.on("keyup",o.commentsPostKeyListner,i,o,true);a.on("focus",o.commentsPostFocusListner,i,o,true);if(a.Lang.isNull(a.one("#ugccmt-container-b"))){o.ult_track("load",a.one("#yom-comments"))}}});var b=a.one("#yom-comments form");var j=b.one("textarea");if(!a.Lang.isNull(b)&&!a.Lang.isNull(j)){a.on("submit",this.commentsPostSubmitListner,b,this,true);a.on("keydown",this.commentsPostKeyListner,j,this,true);a.on("keyup",this.commentsPostKeyListner,j,this,true);a.on("focus",this.commentsPostFocusListner,j,this,true);a.one("#ugccmt-header-top").set("id","ugccmt-header-rendered");if(a.Lang.isNull(a.one("#ugccmt-container-b"))){this.ult_track("load",a.one("#yom-comments"))}}var h=a.one("#top-contributor-overlay");if(h){var d=new a.Overlay({srcNode:"#top-contributor-overlay",visible:false});d.render();h.show();var g=function(i){var t=a.WidgetPositionAlign;d.set("align",{node:i.target,points:[t.TL,t.TR]});d.show()};var n=function(i){if((i.relatedTarget)&&(i.relatedTarget.hasClass("ugccmt-top-contributor-msg")===false&&i.relatedTarget.hasClass("ugccmt-barrow1")===false&&i.relatedTarget.hasClass("ugccmt-barrow2")===false)){d.hide()}};a.delegate("mouseenter",g,"#yom-comments",".ugccmt-top-contributor",this,true);a.delegate("mouseleave",n,"#yom-comments",".ugccmt-top-contributor",this,true);h.on("mouseleave",n)}this.cleanupYWACookies(this.ywaWhitelist)},removeCommentStream:function(e){var d=a.one(".ugccmt-loading");if(d!==null){d.remove()}var b=a.all(".ugccmt-grayed");if(b!==null&&b._nodes.length!==0){b.removeClass("ugccmt-grayed")}if(!a.Lang.isNull(a.one("#ugccmt-container-b"))){a.one("#ugccmt-container-b").remove()}else{if(!a.Lang.isNull(a.one("#ugccmt-container"))){a.one("#ugccmt-container").remove()}}if(!a.Lang.isNull(a.one("#yom-comments"))){var g=this.context_url;if((g.indexOf("?")>=0)){g+="&nopharma=1"}else{if((g.indexOf("?")==-1)){g+="?nopharma=1"}}var f={CLICK_TO_VIEW_COMMENTS:this.oL10n.CLICK_TO_VIEW_COMMENTS,LINK_NO_PHARMA_AD:g};var c=a.substitute(this.unhide_comments_link.show_comments,f);a.one("#yom-comments").setContent(c)}},renderSortList:function(b){var e="";for(var d in this.oSortOptions){if(d==b){e+="<li>"+this.oSortOptions[d]+"</li>"}else{e+='<li><a class ="ugccmt-sort" id="ugccmt-sort-'+d+'" href="#" rel="nofollow">'+this.oSortOptions[d]+"</a></li>"}}if(e!==""){var c=a.one("#ugccmt-sort-list");if(!a.Lang.isNull(c)){c.setContent(e)}}},renderReplyPostFormMarkup:function(g){g.preventDefault();var f=0;var c=g.target._node.id.split("_")[1];var b=a.one("#ugccmt-post-frm-container_"+c);if(typeof g.target._node.className.split("_")[1]!="undefined"&&g.target._node.className.split("_")[1]!==null){f=parseInt(g.target._node.className.split("_")[1],10)}if(!a.Lang.isNull(b)){this.renderPostFormMarkup(b)}var d=a.one("#ugccmt-post-frm_"+c);if(!a.Lang.isNull(d)&&!a.Lang.isNull(d)){a.on("submit",this.commentsPostSubmitListner,d,this,true)}if(f>3){a.one("#ugccmt-view-reply-form_"+c).addClass("ugccmt-sec-hide")}else{a.one("#ugccmt-reply-more-sec_"+c).remove()}},renderPostFormMarkup:function(m){var o="";var f="list";var h=m.get("id").split("_");if(h[0]=="ugccmt-post-frm-container-b"){o="-b";f="bubble"}if(typeof(h[1])!="undefined"){o+="_"+h[1]}var l={POST_BTN_TXT:this.oL10n.POST_BTN_TXT,LEAVE_A_COMMENT:this.oL10n.LEAVE_A_COMMENT,COMMENT_GUIDELINES:this.oL10n.COMMENT_GUIDELINES,PLZ_ENTER_COMMENT:this.oL10n.PLZ_ENTER_COMMENT,comment_guideline_url:this.comment_guideline_url,maxlength:this.maxlength,id_suffix:o};var g="";if(this.bConversations){var n={MSG_START_CONVERSATION:this.oL10n.MSG_START_CONVERSATION,NEW_LABLE:this.oL10n.NEW_LABLE};g=a.substitute(this.conv_link_templates.start_conversation,n)}var p='<div class="ugccmt-form">    <form action="#" method="post" name="ugccmt-post-frm{id_suffix}"  id="ugccmt-post-frm{id_suffix}">           <div class="ugccmt-comment-success-post ugccmt-msg" id="ugccmt-post-frm-success-container{id_suffix}" style="display:none">                <div class="ugccmt-sprite_bg ugccmt-sprite_img success_icon_1"></div>                &nbsp;<span id="ugccmt-post-frm-success{id_suffix}"></span>           </div>           <div class="ugccmt-hd">               <strong class="ugccmt-nick">{LEAVE_A_COMMENT}</strong>               <a rel="nofollow" href="{comment_guideline_url}" name="ugccmt-guideline" class="ugccmt-guideline" target="_blank">{COMMENT_GUIDELINES}</a>           </div>            <div class="ugccmt-avatar-container">               <img src="https://s.yimg.com/os/mit/media/m/base/images/transparent-1093278.png" width="48" height="48" class="ugccmt-avatar" alt="your avatar" align="left" style="background-image:url(https://s.yimg.com/os/mit/media/m/comments/img/profile_48b-1637302.png);">           </div>           <div class="ugccmt-info">               <div class="textwrapper" style="overflow:visible">                   <textarea name="comment_text" id="ugccmt-post-frm-textarea{id_suffix}" rows="2" cols="50" maxlength="{maxlength}" class="ugccmt-comments-post-field"></textarea>                   <div class="ugccmt-user-picker"></div> '+g+'                   <div class="ugccmt-post-button-wrapper">                   <em id="ugccmt-post-frm-charleft{id_suffix}" class="ugccmt-count" aria-live="polite"></em>                   <button id="ugccmt-post-frm-submit{id_suffix}" class="ugccmt-post-button" name="submit" type="submit">{POST_BTN_TXT}</button>                   </div>               </div>           </div>    </form></div>';m.append(a.substitute(p,l));var d="";if(f=="bubble"){d=encodeURIComponent("#ugccmt-post-frm-container"+o)}else{if(typeof(h[1])=="undefined"){d=encodeURIComponent("#ugccmt-post-frm-container")}}var c=this.context_url+d;var k="https://login.yahoo.com/config/login?.src="+this.sRedirectId+"&.lang="+this.sLang+"&.intl="+this.sIntl+"&.done="+c;var b=a.one("#ugccmt-postcommentinternal");if(this.user_guid===""){var j=this.oL10n.POST_AS;var e=this.oL10n.LABEL_OPTIONS;var i='<a href="#" id="ugccmt-post-frm-submit'+o+'" class="ugccmt-post-as-button">'+j+'<img class="ugccmt-post-img-down-arrow" src="https://s.yimg.com/os/mit/media/m/comments/img/postas_dd-1637400.png" alt="'+e+'"/></a>';m.one(".ugccmt-post-button").replace(a.Node.create(i));if(b!==null){b.setAttribute("href",k)}}else{if(b!==null){b.setAttribute("href",d)}}},renderReplyLinksInReply:function(b){a.all("#"+b+" div.ugccmt-render-reply").each(function(e){if(e!==null){var f={link_text:"Reply"};var d='<a id="ugccmt-view-reply{id_suffix}" href="#" class="ugccmt-reply ugccmt-view-reply" rel="nofollow"><span class="ugccmt-sprite_bg right_arrow ugccmt-sprite_img"> </span>  {link_text}</a>';var c=a.substitute(d,f);e.prepend(c)}})},renderReplyLinks:function(b){if(this.sAllowReply!="yes"){return}var e=this;var d="list";var c="";if(b=="ugccmt-container-b"){d="bubble";c="-b"}a.all("#"+b+" div.ugccmt-render-reply").each(function(j){var i=j.one("blockquote");if(!a.Lang.isNull(i)&&i.get("className")!="ugccmt-commenttext-lable"){var m=j.get("parentNode").get("id").split("_");var h=m[1];var k=c+"_"+h;var l=parseInt(m[2],10);var g='<a id="ugccmt-view-reply{id_suffix}" href="#" class="ugccmt-reply ugccmt-view-reply" rel="nofollow"> <span class="ugccmt-sprite_bg right_arrow ugccmt-sprite_img"> </span>  <span id="ugccmt-total-replies{id_suffix}" {style_replace}>{reply_count}</span>  {link_text} </a>';var f={id_suffix:k,reply_count:l,style_replace:"",link_text:""};if(d=="list"){if(l>1){f.link_text=e.oL10n.REPLIES_LINK_TXT}else{if(l==1){f.link_text=e.oL10n.REPLY_LINK_TXT}else{f.link_text=e.oL10n.REPLY_LINK_TXT;f.reply_count=""}}j.append(a.substitute(g,f))}else{if(d=="bubble"&&l>0){f.style_replace='style="display:none"';if(l>1){f.link_text=a.substitute(e.oL10n.VIEW_ALL_REPLIES,{"0":l});j.append(a.substitute(g,f))}else{if(l==1){if(!a.Lang.isNull(j.ancestor(".ugccmt-flyw-trg"))){f.link_text=a.substitute(e.oL10n.VIEW_ALL_REPLY,{"0":l});j.append(a.substitute(g,f))}}}}}j.removeClass("ugccmt-render-reply")}})},renderRateButton:function(b){var e=this;var d="";if(b=="ugccmt-container-b"){d="-b"}var c=[];a.all("#"+b+" div.ugccmt-render-rate").each(function(v){var u=v.get("parentNode").get("id").split("_");var A=u[1];var k=parseInt(u[3],10);var g=parseInt(u[4],10);var C=k+g;var o=(g===0)?0:(g*100/C);var s=d+"_"+A;var m=v.previous().one("img");var l=m.get("id").split("_")[2];var f=v.ancestor(".ugccmt-replies");if(f!==null){var w=f.get("id").split("_")[1];c.push(A+"_"+w)}else{c.push(A)}var q="";var B="";var r="";var i="";if(e.user_guid===""){q=e.oL10n.SIGN_IN_TO_RATE_UP;B=e.oL10n.SIGN_IN_TO_RATE_DOWN;r="blue_thumb_up_lout";i="blue_thumb_down_lout"}else{q=e.oL10n.THUMBS_UP;B=e.oL10n.THUMBS_DOWN;if(e.user_guid==l){r="gray_thumb_up";i="gray_thumb_down"}else{r="blue_thumb_up";i="blue_thumb_down"}}if(C>=e.hide_min_total_rating&o>=e.hide_min_neg_percent_rating){var p='<div class="ugccmt-negative-rating">    {msg_hidden_comment}    <a class="ugccmt-show-hidden-comment" id="{comment_id}|{tu_class}|{td_class}" href="#" rel="nofollow">{lbl_show_hidden_comment}</a></div>';var j={comment_id:A,tu_class:r,td_class:i,msg_hidden_comment:e.oL10n.HIDDEN_DUE_TO_NEG_RATING,lbl_show_hidden_comment:e.oL10n.SHOW_HIDDEN_COMMENT};v.append(a.substitute(p,j));v.one("blockquote").addClass("ugccmt-hide");if(!a.Lang.isNull(v.one("a.ugccmt-reply"))){v.one("a.ugccmt-reply").addClass("ugccmt-hide")}r="gray_thumb_up";i="gray_thumb_down"}var x="";if(e.rating_type=="up_down"||e.rating_type=="up"){x+='<em id="ugccmt-rate-pos{id_suffix}" class="ugccmt-rating-positive {up_class}">{up_count}</em><span class="ugccmt-accessibility-invisible">{up_label}</span><a rel="nofollow" href="#" class="ugccmt-sprite_bg ugccmt-sprite_img {tu_class}" id="ugccmt-rate-tu{id_suffix}">{tu_label}</a>'}if(e.rating_type=="up_down"||e.rating_type=="down"){x+='<a rel="nofollow" href="#" class="ugccmt-sprite_bg ugccmt-sprite_img {td_class}" id="ugccmt-rate-td{id_suffix}">{td_label}</a><em id="ugccmt-rate-neg{id_suffix}" class="ugccmt-rating-negetive {dn_class}">{dn_count}</em><span class="ugccmt-accessibility-invisible">{dn_label}</span>'}if(x!==""){var n={id_suffix:s,up_count:k,dn_count:g,tu_class:r,td_class:i,tu_label:q,td_label:B,up_class:((k>0)?"ugccmt-voted":"ugccmt-rating-zero"),dn_class:((g>0)?"ugccmt-voted-neg":"ugccmt-rating-zero"),up_label:e.oL10n.USERS_LIKED_COMMENT,dn_label:e.oL10n.USERS_DISLIKED_COMMENT};x='<div class="ugccmt-rate">'+x+"</div>";if(v.one(".ugccmt-featured")){v.one(".ugccmt-featured").insert(a.substitute(x,n),"before")}else{v.one("cite").insert(a.substitute(x,n),"before")}}if(e.user_guid!=l){var t='<a id="ugccmt-report-abuse{id_suffix}" class="abuse" href="{report_abuse_guideline_url}" rel="nofollow">{lbl_report_abuse}</a>';var z={id_suffix:s,report_abuse_guideline_url:e.sReportAbuseGuideLineUrl,lbl_report_abuse:e.oL10n.REPORT_ABUSE};v.one("cite").append(a.substitute(t,z))}if(e.user_guid!==""&&e.user_guid==l&&(b!="ugccmt-container-b")){var h='<a id="ugccmt-remove-cmt{id_suffix}" class="ugccmt-remove-cmt" href="#" rel="nofollow">{lbl_remove}</a>';var y={id_suffix:s,lbl_remove:e.oL10n.REMOVE};v.one("cite").append(a.substitute(h,y))}v.removeClass("ugccmt-render-rate")});e.loadUserRatings(c)},renderEllipSizedBox:function(c){var d=this;a.all("#"+c+" blockquote.ugccmt-commenttext").each(function(f){var e=f.ancestor("li").get("id");if(typeof(d.aUgcCommentText[e])=="undefined"){d.commentsShrinkContent(f)}});try{YUI().use("event-custom",function(e){e.Global.fire("media:refreshimages")})}catch(b){}},renderMyProfile:function(){var c=this;if(c.myProfile.user_guid){if(typeof(c.myProfile.user_image)!="undefined"&&c.myProfile.user_image!==""){c.sUserImage=c.myProfile.user_image}if(typeof(c.myProfile.user_nickname)!="undefined"&&c.myProfile.user_nickname!==""){c.sUserNickname=c.myProfile.user_nickname}if(typeof(c.myProfile.user_jurisdiction)!="undefined"&&c.myProfile.user_jurisdiction!==""){c.sUserJurisdiction=c.myProfile.user_jurisdiction}if(typeof(c.myProfile.user_guid)!="undefined"&&c.myProfile.user_guid!==""){c.user_guid=c.myProfile.user_guid}if(typeof(c.myProfile.rcrumb)!="undefined"&&c.myProfile.rcrumb!==""){c.ycrumb=c.myProfile.rcrumb}if(typeof(c.myProfile.user_state)!="undefined"&&c.myProfile.user_state!==""){c.loginStatus=c.myProfile.user_state}a.all("#yom-comments img.ugccmt-avatar").each(function(d){d.setAttribute("src",c.sUserImage);var e=a.Node.create('<span class="ugccmt_change_picture"><a href="https://profile.yahoo.com/'+c.myProfile.user_guid+'" target="_blank">Change</a></span>');if((/yimg\.com\/dh\/ap\/social\/profile\/profile_b48\.png/).test(c.sUserImage)){e.addClass("ugccmt_change_picture_p")}d.insert(e,"after")});a.all("#yom-comments div.ugccmt-hd").each(function(d){d.setContent(c.getUserMarkup())});a.all("div.ugccmt-post-button-wrapper").each(function(i){try{var h;if(i.one("a.ugccmt-post-as-button")!==null&&(typeof i.one("a.ugccmt-post-as-button")!="undefined")){h=i.one("a.ugccmt-post-as-button").get("id").split("_")}else{if(i.one("a.ugccmt-post-as-button-disable")!==null&&(typeof i.one("a.ugccmt-post-as-button-disable")!="undefined")){h=i.one("a.ugccmt-post-as-button-disable").get("id").split("_");i.one("a.ugccmt-post-as-button-disable").replaceClass("ugccmt-post-as-button-disable","ugccmt-post-as-button")}}var d="";var f=c.oL10n.POST_BTN_TXT;if(h[0]=="ugccmt-post-frm-container-b"){d="-b"}if(!a.Lang.isNull(h[1])&&typeof(h[1])!="undefined"){var g=h[1];d+="_"+g}i.setContent('<em id="ugccmt-post-frm-charleft'+d+'" class="ugccmt-count" aria-live="polite"></em><button id="ugccmt-post-frm-submit'+d+'" class="ugccmt-post-button" name="submit" type="submit">'+f+"</button>")}catch(j){}});a.all("a.blue_thumb_up_lout").each(function(d){each_comment_id=d.get("id").split("_")[1];nUserImg=a.one("#ugccmt-comment_"+each_comment_id+" div div a img");if(nUserImg===null){nUserImg=a.one("#ugccmt-comment-b_"+each_comment_id+" div div a img")}cmt_auth_guid=(nUserImg!==null)?nUserImg.get("id").split("_")[2]:"";d.set("text",c.oL10n.RATE_UP);if(c.user_guid==cmt_auth_guid){d.replaceClass("blue_thumb_up_lout","gray_thumb_up")}else{d.replaceClass("blue_thumb_up_lout","blue_thumb_up")}});a.all("a.blue_thumb_down_lout").each(function(d){each_comment_id=d.get("id").split("_")[1];nUserImg=a.one("#ugccmt-comment_"+each_comment_id+" div div a img");if(nUserImg===null){nUserImg=a.one("#ugccmt-comment-b_"+each_comment_id+" div div a img")}cmt_auth_guid=(nUserImg!==null)?nUserImg.get("id").split("_")[2]:"";d.set("text",c.oL10n.RATE_DOWN);if(c.user_guid==cmt_auth_guid){d.replaceClass("blue_thumb_down_lout","gray_thumb_down")}else{d.replaceClass("blue_thumb_down_lout","blue_thumb_down")}});c.renderRemoveReportAbuse("ugccmt-container");c.append_mycmt_tab();var b=[];a.all("#ugccmt-container div.ugccmt-comment").each(function(f){var g=f.get("id").split("_");var e=g[1];var d=f.ancestor(".ugccmt-replies");if(d!==null){var h=d.get("id").split("_")[1];b.push(e+"_"+h)}else{b.push(e)}});a.all("#ugccmt-container-b div.ugccmt-comment").each(function(f){var g=f.get("id").split("_");var e=g[1];var d=f.ancestor(".ugccmt-replies");if(d!==null){var h=d.get("id").split("_")[1];b.push(e+"_"+h)}else{b.push(e)}});c.enable_rating_buttons();c.loadUserRatings(b)}},loadDisclosure:function(){var h=this;var f=a.one("#yom-comments div.ugccmt-user-picker");var j="ugccmt-load-disclosure-preloader";var b=this.aXHR.GET_DISCLOSURE+"&context_id="+this.context_id+"&"+Math.random();b+=this.bucket_publisher_id_url;b+="&baseurl="+encodeURIComponent(this.context_url);var c="";var e="";var g="";this.disClosureLoader="active";this.showPreloader(j,"ugccmt-load-disclosure-preloader",f,"append");this.enable_post_as_btn(false);function d(p,n){h.disClosureLoader="end";h.updatePreloader(j,"");try{var m=a.JSON.parse(n.responseText);if(n.responseText!==""&&typeof m!="undefined"&&typeof m.user_guid!="undefined"){if(typeof(m.user_image)!="undefined"&&m.user_image!==""){h.sUserImage=m.user_image}if(typeof(m.user_nickname)!="undefined"&&m.user_nickname!==""){h.sUserNickname=m.user_nickname}if(typeof(m.user_jurisdiction)!="undefined"&&m.user_jurisdiction!==""){h.sUserJurisdiction=m.user_jurisdiction}if(typeof(m.user_guid)!="undefined"&&m.user_guid!==""){h.user_guid=m.user_guid}if(typeof(m.rcrumb)!="undefined"&&m.rcrumb!==""){h.ycrumb=m.rcrumb}if(typeof(m.user_state)!="undefined"&&m.user_state!==""){h.loginStatus=m.user_state}if(typeof(m.location)!="undefined"){if(typeof(m.location.city)!="undefined"&&m.location.city!==""){h.oUserLocation={city:m.location.city,ctry:m.location.ctry,lat:m.location.lat,lon:m.location.lon,woe:m.location.woe,is_checkin:m.location.is_checkin,is_sharelocation:m.location.is_sharelocation}}}a.all("#yom-comments img.ugccmt-avatar").each(function(o){o.setAttribute("src",h.sUserImage)});a.all("#yom-comments div.ugccmt-hd").each(function(o){o.setContent(h.getUserMarkup());h.initLocWidget(o)});a.all("div.ugccmt-post-button-wrapper").each(function(t){try{var s;if(t.one("a.ugccmt-post-as-button")!==null&&(typeof t.one("a.ugccmt-post-as-button")!="undefined")){s=t.one("a.ugccmt-post-as-button").get("id").split("_")}else{if(t.one("a.ugccmt-post-as-button-disable")!==null&&(typeof t.one("a.ugccmt-post-as-button-disable")!="undefined")){s=t.one("a.ugccmt-post-as-button-disable").get("id").split("_");t.one("a.ugccmt-post-as-button-disable").replaceClass("ugccmt-post-as-button-disable","ugccmt-post-as-button")}}var o="";var q=h.oL10n.POST_BTN_TXT;if(s[0]=="ugccmt-post-frm-container-b"){o="-b"}if(!a.Lang.isNull(s[1])&&typeof(s[1])!="undefined"){var r=s[1];o+="_"+r}t.setContent('<em id="ugccmt-post-frm-charleft'+o+'" class="ugccmt-count" aria-live="polite"></em><button id="ugccmt-post-frm-submit'+o+'" class="ugccmt-post-button" name="submit" type="submit">'+q+"</button>")}catch(u){}});a.all("a.blue_thumb_up_lout").each(function(o){e=o.get("id").split("_")[1];g=a.one("#ugccmt-comment_"+e+" div div a img");if(g===null){g=a.one("#ugccmt-comment-b_"+e+" div div a img")}c=(g!==null)?g.get("id").split("_")[2]:"";o.set("text",h.oL10n.RATE_UP);if(h.user_guid==c){o.replaceClass("blue_thumb_up_lout","gray_thumb_up")}else{o.replaceClass("blue_thumb_up_lout","blue_thumb_up")}});a.all("a.blue_thumb_down_lout").each(function(o){e=o.get("id").split("_")[1];g=a.one("#ugccmt-comment_"+e+" div div a img");if(g===null){g=a.one("#ugccmt-comment-b_"+e+" div div a img")}c=(g!==null)?g.get("id").split("_")[2]:"";o.set("text",h.oL10n.RATE_DOWN);if(h.user_guid==c){o.replaceClass("blue_thumb_down_lout","gray_thumb_down")}else{o.replaceClass("blue_thumb_down_lout","blue_thumb_down")}});h.renderRemoveReportAbuse("ugccmt-container");h.append_mycmt_tab();var l=[];a.all("#ugccmt-container div.ugccmt-comment").each(function(r){var s=r.get("id").split("_");var q=s[1];var o=r.ancestor(".ugccmt-replies");if(o!==null){var t=o.get("id").split("_")[1];l.push(q+"_"+t)}else{l.push(q)}});a.all("#ugccmt-container-b div.ugccmt-comment").each(function(r){var s=r.get("id").split("_");var q=s[1];var o=r.ancestor(".ugccmt-replies");if(o!==null){var t=o.get("id").split("_")[1];l.push(q+"_"+t)}else{l.push(q)}});h.enable_rating_buttons();h.loadUserRatings(l)}}catch(k){a.io(h.aXHR.ERR_LOG+"TryLoadDisclosureFail&err_response_body="+escape(n.responseText)+"&catch_ms="+k)}return}function i(l,k){h.disClosureLoader="end";h.updatePreloader(j,"");a.io(h.aXHR.ERR_LOG+"LoadDisclosureFail&err_response_body="+escape(k.responseText))}a.io(b,{on:{success:d,failure:i,end:function(l,k){this.enable_post_as_btn(true)}},context:this})},enable_post_as_btn:function(b){if(b){var c=a.one("#yom-comments .ugccmt-post-as-button-disable");if(c){c.replaceClass("ugccmt-post-as-button-disable","ugccmt-post-as-button")}}else{var c=a.one("#yom-comments .ugccmt-post-as-button");if(c){c.replaceClass("ugccmt-post-as-button","ugccmt-post-as-button-disable")}}},disable_post_rate_btns:function(){if(this.oLoginWindow!==null&&this.oLoginWindow.closed!==true){a.all("#yom-comments a.ugccmt-post-as-button").each(function(b){b.replaceClass("ugccmt-post-as-button","ugccmt-post-as-button-disable")});a.all("#yom-comments div.ugccmt-rate").each(function(b){b.all("a").each(function(c){if(c.get("className").match(/thumb_up/g)&&(!c.hasClass("gray_thumb_up_tmp"))){c.addClass("gray_thumb_up_tmp")}if(c.get("className").match(/thumb_down/g)&&(!c.hasClass("gray_thumb_down_tmp"))){c.addClass("gray_thumb_down_tmp")}})});a.all("#yom-comments a.blue_thumb_up_lout").each(function(b){if(!b.hasClass("gray_thumb_up_tmp")){b.addClass("gray_thumb_up_tmp")}});a.all("#yom-comments a.blue_thumb_down_lout").each(function(b){if(!b.hasClass("gray_thumb_down_tmp")){b.addClass("gray_thumb_down_tmp")}})}},loadUserRatings:function(d){if(this.bEnableBloomfilter!=1){return}if(d.length===0||this.user_guid===""){return}var g=this;var e=this.aXHR.USER_RATINGS+"&context_id="+this.context_id+"&"+Math.random();e+=this.bucket_publisher_id_url;var c={};c.comment_ids=d.join(",");function f(k,j){try{var i=a.JSON.parse(j.responseText);if(typeof i.rated_comments!="undefined"){g.updateRateButton(i.rated_comments)}}catch(h){a.io(g.aXHR.ERR_LOG+"TryLoadUserRatingFail&err_response_body="+escape(j.responseText)+"&catch_ms="+h);return}}function b(i,h){a.io(g.aXHR.ERR_LOG+"LoadUserRatingFailure&err_response_body="+escape(h.responseText))}a.io(e,{on:{success:f,failure:b},method:"POST",data:c,context:this,"arguments":{argument:this}})},updateRateButton:function(e){if(!(e instanceof Array)){return}for(var b=0;b<e.length;b++){var d=a.one("#ugccmt-rate-tu_"+e[b].id);var c=a.one("#ugccmt-rate-td_"+e[b].id);if(d!==null&&c!==null){if(e[b].ratingValue=="thumbsUp"){d.addClass("green_thumb_up_nobr");c.addClass("gray_thumb_down_nobr")}else{d.addClass("gray_thumb_up_nobr");c.addClass("red_thumb_down_nobr")}d.removeClass("gray_thumb_up");d.removeClass("blue_thumb_up");c.removeClass("gray_thumb_down");c.removeClass("blue_thumb_down")}}},expandContentHandler:function(d){var c=d.ancestor("li");var e=c.one("blockquote.ugccmt-commenttext");var b=c.get("id");e.setContent(this.aUgcCommentText[b])},commentsShrinkContent:function(o){var b=this.sCharCountCommentWordCount;var d=o.getContent();var u=d.length;var p=0;var m=true;var w=0;var v="";var t="";var h=o.ancestor("li").get("id");this.aUgcCommentText[h]=d;for(var s=0;s<u;s++){var c=d.charCodeAt(s);if(55296<=c&&c<=56319){var n=d.charCodeAt(s+1);if(56320>n||n>57343){m=false}else{p++}}else{p++}}var f=d.split(/<br.*?>/gi);if(p>b){if(!m){w=b;for(var q=0;q<w;q++){v+=d.charAt(q);if(/[\uD800-\uDBFF]/.test(d.charAt(q))&&/[\uDC00-\uDFFF]/.test(d.charAt(q+1))){w++}}t=v}else{t=d.substring(0,b)}for(var r=t.length;r>0;r--){var g=t.charCodeAt(r);if(g==32||g==46||g==44||g==59||g==58||g==12289){t=t.substring(0,r);break}}p=b;o.setContent(t+'... <a class="ugccmt-expand" href="#" rel="nofollow">'+this.oL10n.VIEW_MORE+"</a>")}if(typeof(f)!="undefined"&&!a.Lang.isNull(f)&&(f.length>4)){var e="";if(f[0].length<=b){e=f[0]+"<br/>"}if((f[1].length+e.length)<=b){e+=f[1]+"<br/>"}if((f[2].length+e.length)<=b){e+=f[2]}if(((e.length)<=b)&&(e!=="")){o.setContent(e+'... <a class="ugccmt-expand" href="#" rel="nofollow">'+this.oL10n.VIEW_MORE+"</a>")}}},checkCommentsInViewPort:function(f){var e=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);var b=a.one("body").get("winHeight");var d=parseInt(b+e,10);var c=parseFloat((f.custobj.getY()+f.custobj.get("region").height)).toFixed(0);a.on("scroll",this.commentsTrackTimer,window,this,{custobj:a.one("#yom-comments")});if((d<=(c))&&(d>=f.custobj.getY())&&(parseInt(this.timerStart,10)===0)){this.timerStart=new Date().getTime();if(this.timeTracker===0){a.once("beforeunload",this.beaconCommentsTimeSpent,window,this);this.timeTracker=1}}},scrollCalc:function(g,f){var h=this;var d=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);var b=a.one("body").get("winHeight");var c=parseInt(b+d,10);if(c>=f.custobj.getY()){a.detach("scroll",h.scrollCalc,window);if(f.custobj.get("id")=="yom-comments"){h.ult_track("c_start",a.one("#yom-comments"));if(!a.Lang.isNull(a.one("#ugccmt-postcommentinternal"))){a.on("scroll",this.scrollCalc,window,this,{custobj:a.one("#ugccmt-postcommentinternal")})}}else{if(f.custobj.get("id")=="ugccmt-postcommentinternal"){h.ult_track("c_end",a.one("#yom-comments"))}}}},commentsTrackTimer:function(h,g){var f=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);var b=a.one("body").get("winHeight");var d=parseInt(b+f,10);var c=parseFloat((g.custobj.getY()+g.custobj.get("region").height)).toFixed(0);if((d<=(c))&&(d>=g.custobj.getY())){if(parseInt(this.timerStart,10)===0){this.timerStart=new Date().getTime()}if(this.timeTracker===0){a.once("beforeunload",this.beaconCommentsTimeSpent,window,this);this.timeTracker=1}}else{if(parseInt(this.timerStart,10)!==0){this.timeSpentTimer=parseFloat(parseInt(this.timeSpentTimer,10)+parseInt(parseInt(new Date().getTime(),10)-parseInt(this.timerStart,10),10)).toFixed(0);this.timerStart=0}}},beaconCommentsTimeSpent:function(){this.ult_track("c_tspent",a.one("#yom-comments"))},getCmtTimeSpent:function(){if(parseFloat(this.timeSpentTimer).toFixed(0)===0){this.timeSpentTimer=parseFloat(this.timeSpentTimer+parseInt(new Date().getTime()-this.timerStart,10)).toFixed(0)}this.timeSpentTimer=parseFloat(this.timeSpentTimer/1000).toFixed(0);if(this.timeSpentTimer>1800000){this.timeSpentTimer=1800000}return this.timeSpentTimer},extractUserData:function(e){if(!this.userData){this.userData={}}var d=e.get("id").split("_")[1];if(typeof(this.userData[d])=="undefined"){var c;var b={};b.uid=d;if(e.get("className")=="ugccmt-user-cmt"){b.name=e.get("firstChild").getContent()}else{if((e.get("className")=="ugccmt-user-cmt-img")){if(e._node.children[0]!==null){b.name=e._node.children[0].alt}}}while((e.get("parentNode").get("parentNode.tagName").trim()!="ul")||(e.get("parentNode").get("parentNode.tagName").trim()!="body")){e=e.get("parentNode");if(e.get("parentNode.tagName").trim().toLowerCase()=="li"){c=e.get("parentNode");break}}if((!a.Lang.isNull(c))&&(!a.Lang.isNull(c.one(".ugccmt-avatar-container")))&&(!a.Lang.isNull(c.one("img")))){b.img=c.one("img").get("parentNode").getContent();b.imgUrl=c.one("img").getStyle("backgroundImage");if(b.imgUrl==null||b.imgUrl=="none"){b.imgUrl=c.one("img").get("src")}else{b.imgUrl=b.imgUrl.substr(4,b.imgUrl.length-5)}}this.userData[d]=b}return this.userData[d]},commentsClickListner:function(O,K){var I=O.target;this.hideErrorOverlay();var s=this.isGoodTarget(I,["ugccmt-disabled"],5);if(s){O.preventDefault();return}var k=I.get("id");if(k==="ugccmt-hide-all-button"){var l=a.one("#ugccmt-container");l.removeClass("hide");I.addClass("hide");O.preventDefault();return}var b=this.isGoodTarget(I,["loc-share"],2);if(b){this.onClickLocationSharePrefHandle(b);return}b=this.isGoodTarget(I,["ugccmt-comment-location"],2);if(b){O.preventDefault();this.onClickCommentLocation(b);return}var F=this.isGoodTarget(I,["ugccmt-location-cloud-toggle"],2);if(F){O.preventDefault();this._toggleLocationCloud();return}var G=this.isGoodTarget(I,["ugccmt-topic-cloud-toggle"],2);if(G){O.preventDefault();this._toggleTopicCloud();return}b=this.isGoodTarget(I,["ugccmt-fltr-loc-close"],2);if(b){O.preventDefault();this.onClickCommentLocationClose(b);return}b=this.isGoodTarget(I,["ugccmt-fltr-toc-close"],2);if(b){O.preventDefault();this.onClickCommentTopicClose(b);return}b=this.isGoodTarget(I,["ugccmt-fltr-usr-close"],2);if(b){O.preventDefault();this.onClickCommentUserClose(b);return}b=this.isGoodTarget(I,["ugccmt-fltr-disabled"],3);if(b){O.preventDefault();return}b=this.isGoodTarget(I,["loc-help"],3);if(b){O.preventDefault();this.showLocationHelp(b);return}b=this.isGoodTarget(I,["ugccmt-user-cmt","ugccmt-user-cmt-img","ugccmt-user-badge"],5);if(b){if(b.hasClass("ugccmt-user-badge")){b=b.previous("a.ugccmt-user-cmt-img")}if(this.currentUserUid&&this.isUserCommentsTab()&&b.get("id").indexOf(this.currentUserUid)!=-1){return true}if(this.bEnableUserComments==1){var m=this.extractUserData(b);var w=a.one(".ugccmt-ucard-name a");if(w!=null&&w.getHTML()!=null&&m.name==w.getHTML().trim()){return}else{O.preventDefault();this._render_UserCmtTab(m);return}}}b=this.isGoodTarget(I,["ugccmt-link-toc1","ugccmt-link-toc2","ugccmt-link-toc3","ugccmt-link-toc4","ugccmt-link-toc5"],5);if(b){O.preventDefault();this.markTcBlockActive(b);return}var v=this.isGoodTarget(I,["ugccmt-view-all"],5);if(v){O.preventDefault();if(this.ioState===0){this.ioState=1;this.ult_track("flw_all",I);this.viewAllCommentsHandler(v)}return}var g=this.isGoodTarget(I,["ugccmt-fltr"],3);if(g){O.preventDefault();if(this.ioState===0){this.ioState=1;if(g.get("id")=="ugccmt-fltr-usr"){this._render_UserCmtTab(this.userData[this.currentUserUid])}else{this.ult_track("f_"+g.get("id").split("-")[2],I);this.fltrCommentsHandler(g)}}return}var D=this.isGoodTarget(I,["ugccmt-sort"],5);if(D){O.preventDefault();if(this.ioState===0){this.ioState=1;this.ult_track("s_"+D.get("id").split("-")[2],I);this.sortCommentsHandler(D)}return}var q=this.isGoodTarget(I,["ugccmt-view-more"],5);if(q){O.preventDefault();if(this.ioState===0){this.ioState=1;this.ult_track("c_more",I);this.viewMoreCommentsHandler(q)}return}var N=this.isGoodTarget(I,["ugccmt-view-reply"],5);if(N){O.preventDefault();if(this.ioState===0){this.ioState=1;this.viewReplyHandler(N)}return}var r=this.isGoodTarget(I,["blue_thumb_up","blue_thumb_down"],5);if(r){O.preventDefault();this.rateCommentsHandler(r);return}var J=this.isGoodTarget(I,["abuse"],5);if(J){O.preventDefault();if(this.user_guid===""){this.commentsOverlayMessage(J,this.oL10n.REPORT_ABUSE);return}this.ult_track("c_abuse",I);this.reportAbuseHandler(J);return}var i=this.isGoodTarget(I,["ugccmt-remove-cmt"],5);if(i){O.preventDefault();this.askremoveCmtHandler(i);return}var f=this.isGoodTarget(I,["ugccmt-delete-cmt"],5);if(f){O.preventDefault();this.removeCmtHandler(f);return}var L=this.isGoodTarget(I,["ugccmt-cancle-delete-cmt"],5);if(L){O.preventDefault();this.cancleremoveCmtHandler(L);return}var H=this.isGoodTarget(I,["ugccmt-expand"],5);if(H){O.preventDefault();this.ult_track("c_expand",I);this.expandContentHandler(H);return}var n=this.isGoodTarget(I,["green_thumb_up_nobr","red_thumb_down_nobr","gray_thumb_down_nobr","gray_thumb_up_nobr","gray_thumb_down","gray_thumb_up"],5);if(n){O.preventDefault();return}var B=this.isGoodTarget(I,["blue_thumb_up_lout","blue_thumb_down_lout"],2);if(B){O.preventDefault();if(I.get("className").match(/gray_thumb_up_tmp/g)||I.get("className").match(/gray_thumb_down_tmp/g)){return}if(I.get("className").match(/thumb_up/g)){this.logOutRateVal="up"}else{if(I.get("className").match(/thumb_down/g)){this.logOutRateVal="down"}}this.commentsOverlayMessage(B,this.oL10n.RATE_AS);return}var d=this.isGoodTarget(I,["ugccmt-post-as-button"],2);if(d){O.preventDefault();this.commentsOverlayMessage(d,null);return}var p=this.isGoodTarget(I,["ugccmt-post-as-button-disable"],2);if(p){O.preventDefault();return}b=this.isGoodTarget(I,["ugccmt-login"],5);if(b){O.preventDefault();var u=b.get("parentNode").get("parentNode").get("parentNode").get("id");if(u=="ugccmt-overlay-login-post"){this.inlineLoginHandler(b,"post")}else{if(u=="ugccmt-overlay-login-rate"){this.inlineLoginHandler(b,"rate")}}return}if(!B&&(this.oOverlayContainer.logout)){this.oOverlayContainer.logout.hide()}var y=this.isGoodTarget(I,["ugccmt-comments-post-field"],5);if(y){var E="";if(!a.Lang.isNull(a.one("#ugccmt-container-b"))&&a.one("#ugccmt-container-b").contains(I)){E="-b"}var Q=y.get("id").split("_")[1];if(typeof(Q)!="undefined"&&!a.Lang.isNull(Q)){E+="_"+Q}var A=a.one("#ugccmt-post-frm-error-cntainer"+E);if(!a.Lang.isNull(A)){A.get("parentNode").removeChild(A)}return}var j=this.isGoodTarget(I,["ugccmt-postcommentinternal"],5);if(j){var c=a.one("#ugccmt-comments-post-success");if(!a.Lang.isNull(c)){c.get("parentNode").removeChild(c);var P=a.one("#ugccmt-post-frm-container div.ugccmt-hd");P.setStyle("display","block");a.one("#ugccmt-post-frm").setStyle("display","block");a.one("#ugccmt-post-frm-charleft").setContent(this.sCharCountAllowed)}if((!a.Lang.isNull(a.one("#ugccmt-post-frm-textarea")))&&(a.one("#ugccmt-post-frm-container").getStyle("display")!="none")){try{var o=a.one("#ugccmt-post-frm-container").getXY();var R=a.one("#yucsHead");var C=0;if(R){var M=R.getXY();if(M[1]>0){C=parseInt(R.getComputedStyle("height"),10)}}window.scrollTo(o[0],o[1]-C);a.one("#ugccmt-post-frm-textarea").focus();O.preventDefault()}catch(x){}return}}var h=this.isGoodTarget(I,["ugccmt-show-hidden-comment"],2);if(h){O.preventDefault();this._showHiddenComment(h);return}b=this.isGoodTarget(I,["ugccmt-rpt-abuse-cat"],2);if(b){O.preventDefault();this.createAbuseMarkup(O);return}var z=this.isGoodTarget(I,["ugccmt-start-conv-link"],1);if(z){O.preventDefault();this._onStartConversationClick();this.ult_track("c_sconverse",I);return}var b=this.isGoodTarget(I,["eo-confirm","eo-confirm-yes","eo-confirm-no"],5);if(b){O.preventDefault();this.eoConfirm(b);return}return},commentsPostSubmitListner:function(d,c){var b=d.target;d.preventDefault();this.postCommentHandler(b)},commentsPostFocusListner:function(f,d){var b=f.target.get("parentNode").one("div.ugccmt-user-picker");if(b.getStyle("opacity")!=1){var c=new a.Anim({node:b,from:{opacity:0},to:{opacity:1},easing:a.Easing.easeOut,duration:1});c.run()}},commentsPostKeyListner:function(t,k){var b=this.sCharCountAllowed;var d=t.target;var f=d.get("value").replace(/(\r\n)+/g,"\n");var u=f.length;var p=0;var m=true;var x=0;var v="";for(var s=0;s<u;s++){var c=f.charCodeAt(s);if(55296<=c&&c<=56319){var o=f.charCodeAt(s+1);if(56320>o||o>57343){m=false}else{p++}}else{p++}}if(p>b){if(!m){x=b;for(var q=0;q<x;q++){v+=f.charAt(q);if(/[\uD800-\uDBFF]/.test(f.charAt(q))&&/[\uDC00-\uDFFF]/.test(f.charAt(q+1))){x++}}d.set("value",v)}else{d.set("value",f.substring(0,b))}p=b}var h=b-p;if(h<100){var n=d.get("parentNode").one("em.ugccmt-count");n.setContent(h)}var g=d.get("parentNode").one("div.ugccmt_textarea_clone");if(a.Lang.isNull(g)){g=a.Node.create('<div class="ugccmt_textarea_clone" style="width:'+d.get("clientWidth")+'px;"></div>');d.get("parentNode").append(g)}var w=d.get("value");w=w.replace(/&/g,"&");w=w.replace(/ {2}/g,"ï¿½");w=w.replace(/<|>/g,">");w=w.replace(/\n/g,"<br />");g.setContent("     "+w);if(g.get("clientHeight")>d.get("clientHeight")){d.setStyle("height",g.get("clientHeight")+14+"px");if(d.get("id")=="ugccmt-post-frm-textarea"){a.one("#ugccmt-comments").setStyle("display","none");a.one("#ugccmt-comments").setStyle("display","")}}else{if(g.get("clientHeight")<d.get("clientHeight")-18){d.setStyle("height",Math.max(46,g.get("clientHeight")+14)+"px");if(d.get("id")=="ugccmt-post-frm-textarea"){a.one("#ugccmt-comments").setStyle("display","none");a.one("#ugccmt-comments").setStyle("display","")}}}},sortCommentsHandler:function(f){var g=this;var e="ugccmt-sort-preloader";this.sCurrentSortBy=f.get("id").split("-")[2];this.showPreloader(e,"ugccmt-sort-preloader",f.get("parentNode"),"append");var c=this.aXHR.GET_LIST+"&context_id="+this.context_id+"&"+Math.random();c+="&ugccmtnav="+encodeURIComponent("v1/comments/context/"+this.context_id+"/comments?fetchReplies=true&count="+this.sPerPage+"&sortBy="+this.sCurrentSortBy);c+="&mode=list&baseurl="+encodeURIComponent(this.context_url);c+=this.bucket_publisher_id_url;function d(l,k,j){try{var i=a.JSON.parse(k.responseText);if(typeof i.markup!="undefined"&&i.markup!==""){g.removePreloader(e);g.renderSortList(g.sCurrentSortBy);g._render_CommentStream(i)}else{g.updatePreloader(e,g.oL10n.SERVER_ERROR,g.oL10n.ERR_SORT_RSP_EMPTY);a.io(g.aXHR.ERR_LOG+g.oL10n.ERR_SORT_RSP_EMPTY+"&err_response_body="+escape(k.responseText))}}catch(h){g.updatePreloader(e,g.oL10n.SERVER_ERROR,g.oL10n.ERR_SORT_RSP_INVALID);a.io(g.aXHR.ERR_LOG+g.oL10n.ERR_SORT_RSP_INVALID+"&err_response_body="+escape(k.responseText)+"&catch_ms="+h);return}}function b(j,i,h){g.updatePreloader(e,g.oL10n.REQUEST_FAILED,g.oL10n.ERR_SORT_FAILURE);a.io(g.aXHR.ERR_LOG+g.oL10n.ERR_SORT_FAILURE+"&err_response_body="+escape(i.responseText))}a.io(c,{on:{success:d,failure:b},context:this,"arguments":{argument:this}})},toggleCommentPostBox:function(b){if((!a.Lang.isNull(a.one("#ugccmt-post-frm-container")))&&(b=="hide")&&(a.one("#ugccmt-post-frm-container").getStyle("display")!="none")){a.one("#ugccmt-post-frm-container").setStyle("display","none")}else{if((!a.Lang.isNull(a.one("#ugccmt-post-frm-container")))&&(a.one("#ugccmt-post-frm-container").getStyle("display")=="none")){a.one("#ugccmt-post-frm-container").setStyle("display","")}}if(!a.Lang.isNull(a.one("#ugccmt-postcommentinternal"))&&(a.one("#ugccmt-postcommentinternal").getStyle("display")!="none")){a.one("#ugccmt-postcommentinternal").setStyle("display","none")}else{if((!a.Lang.isNull(a.one("#ugccmt-post-frm-container")))&&(a.one("#ugccmt-postcommentinternal").getStyle("display")=="none")){a.one("#ugccmt-postcommentinternal").setStyle("display","")}}},toggleCommentLocationCloud:function(b){if((!a.Lang.isNull(a.one(".ugccmt-location-cloud-container")))&&(!a.Lang.isNull(a.one(".ugccmt-location-cloud")))&&(b=="hide")&&(a.one(".ugccmt-location-cloud-container").getStyle("display")!="none")){a.one(".ugccmt-location-cloud-container").setStyle("display","none")}else{if((!a.Lang.isNull(a.one(".ugccmt-location-cloud-container")))&&(!a.Lang.isNull(a.one(".ugccmt-location-cloud")))&&(a.one(".ugccmt-location-cloud-container").getStyle("display")=="none")){a.one(".ugccmt-location-cloud-container").setStyle("display","block")}}},toggleUserCommentHeader:function(b,d,f){if(!a.Lang.isNull(a.one("#ugccmt-post-frm-container"))&&b=="create"){if(!a.Lang.isNull(a.one(".ugccmt-ucard-header"))){a.one(".ugccmt-ucard-header").remove()}var c="";var g="";a.all("div.ugccmt-comment").each(function(h){if(!a.Lang.isNull(h.one(".ugccmt-comment-location"))&&c===""){c=h.one(".ugccmt-comment-location").get("firstChild").getContent().trim()}});var e=a.Node.create('<div class="ugccmt-ucard-header clearfix"></div>');e.setContent('   <div class="ugccmt-avatar-container">       <a href="https://profile.yahoo.com/'+d.uid+'" target="_blank">           '+d.img+'       </a>   </div>   <div class="ugccmt-ucard-info" >      <div class="ugccmt-ucard-name">           <a class="ugccmt-ucard-link" href="https://profile.yahoo.com/'+d.uid+'" target="_blank">           '+d.name+'           </a>           <span class="ugccmt-view-profile"> (<a href="https://profile.yahoo.com/'+d.uid+'" target="_blank">           '+this.oL10n.VIEW_PROFILE+"           </a>)</span>"+f.top_contributor_markup+'      </div>      <div class="ugccmt-ucard-location" style="color: #004F94; padding-top: 0; font-weight: bold;">'+c+"      </div>"+f.editor_actions_markup+'      <div class="ugccmt-ucard-activity">           <span class="ugccmt-atotal">'+f.total_msg+'</span>           <span>|</span>           <span class="ugccmt-atime">'+f.last_activity+"</span>      </div>   </div>"+f.topical_expert_markup);if(!a.Lang.isNull(a.one(".ugccmt-sort-list-container"))){a.one(".ugccmt-sort-list-container").insert(e,"before")}}else{if(!a.Lang.isNull(a.one(".ugccmt-ucard-header"))&&b=="remove"){a.one(".ugccmt-ucard-header").remove()}}},fltrCommentsHandler:function(j,i){var b="ugccmt-fltr-preloader";var k=j.get("id");this.showPreloader(b,"ugccmt-fltr-preloader",j.one("a.ugccmt-fltr-link"),"append");var c=this.aXHR.GET_LIST+"&context_id="+this.context_id+"&"+Math.random();var e="";if(k=="ugccmt-fltr-my"||k=="ugccmt-fltr-usr"){var h=k=="ugccmt-fltr-my"?this.user_guid:i.uid;this.sCurrentFltrBy=h==this.user_guid?"my":"usr";c=this.aXHR.GET_USER_CMT+"&context_id="+this.context_id+"&"+Math.random();c+="&ugccmtnav="+encodeURIComponent("v1/comments/"+h+"/activities?fetchParentComments=true");c+="&guid="+h}else{if(k=="ugccmt-fltr-loc"||k=="ugccmt-comment-location"){this.sCurrentFltrBy="loc";var l=a.one("#ugccmt-fltr-loc .ugccmt-fltr-loc-geo").get("id").split("_");if(isNaN(parseFloat(l[1]))){e="&location=0_0_"+encodeURIComponent(l[1])}else{e="&woeid="+encodeURIComponent(l[1])}c+="&ugccmtnav="+encodeURIComponent("v1/comments/context/"+this.context_id+"/comments?count="+this.sPerPage+e+"&sortBy=highestRated")}else{if(k=="ugccmt-fltr-toc"){this.sCurrentFltrBy="toc";var g=a.one("#ugccmt-fltr-toc .ugccmt-fltr-toc").get("id").split("_");if(isNaN(parseFloat(g[1]))){e="&topicCloudFilter=0"}else{e="&topicCloudFilter="+encodeURIComponent(g[1])}c+="&ugccmtnav="+encodeURIComponent("v1/comments/context/"+this.context_id+"/comments?count="+this.sPerPage+e+"&sortBy=highestRated")}else{this.sCurrentFltrBy="all";c+="&ugccmtnav="+encodeURIComponent("v1/comments/context/"+this.context_id+"/comments?count="+this.sPerPage+"&sortBy="+this.sCurrentSortBy)}}}c+="&mode=list&baseurl="+encodeURIComponent(this.context_url);c+=this.bucket_publisher_id_url;function d(t,s,q){try{var p=a.JSON.parse(s.responseText);if(typeof p.markup!="undefined"){if(q.filter=="all"||q.filter=="usr"){q.argument.markTcBlockActive()}else{if(q.filter=="toc"){q.argument.markRemoteTcBlockActive(a.one("#ugccmt-fltr-toc .ugccmt-fltr-toc"))}}q.argument.removePreloader(b);q.argument._reset_FilterTabs(k);q.argument._render_CommentStream(p);if(q.filter=="usr"){q.argument.toggleCommentPostBox("hide");q.argument.toggleCommentLocationCloud("hide");q.argument.toggleUserCommentHeader("create",q.usercard,p);a.one(".ugccmt-sort-list-container").addClass("ugccmt-hidden");a.one("#ugccmt-container").addClass("ugccmt-usrcmts")}else{if(q.filter=="my"){q.argument.toggleCommentPostBox("hide");q.argument.toggleCommentLocationCloud("hide");a.one(".ugccmt-sort-list-container").addClass("ugccmt-hidden");a.one("#ugccmt-container").addClass("ugccmt-usrcmts");var r=a.one("#ugccmt-user-guidn_"+this.user_guid);if(r){var n=this.extractUserData(r);q.argument.toggleUserCommentHeader("create",n,p)}else{q.argument.toggleUserCommentHeader("remove")}}else{q.argument.toggleCommentPostBox();q.argument.toggleCommentLocationCloud();q.argument.toggleUserCommentHeader("remove");a.one(".ugccmt-sort-list-container").removeClass("ugccmt-hidden");a.one("#ugccmt-container").removeClass("ugccmt-usrcmts")}}}else{q.argument.updatePreloader(b,q.argument.oL10n.SERVER_ERROR,q.argument.oL10n.ERR_FLTR_RSP_EMPTY);a.io(q.argument.aXHR.ERR_LOG+q.argument.oL10n.ERR_FLTR_RSP_EMPTY+"&err_response_body="+escape(s.responseText))}}catch(m){q.argument.updatePreloader(b,q.argument.oL10n.SERVER_ERROR,q.argument.oL10n.ERR_FLTR_RSP_INVALID);a.io(q.argument.aXHR.ERR_LOG+q.argument.oL10n.ERR_FLTR_RSP_INVALID+"&err_response_body="+escape(s.responseText)+"&catch_ms="+m);return}}function f(p,n,m){m.updatePreloader(b,m.argument.oL10n.REQUEST_FAILED,m.argument.oL10n.ERR_FLTR_RSP_FAILURE);a.io(m.argument.aXHR.ERR_LOG+m.argument.oL10n.ERR_FLTR_RSP_FAILURE+"&err_response_body="+escape(n.responseText))}a.io(c,{on:{success:d,failure:f},context:this,"arguments":{argument:this,filter:this.sCurrentFltrBy,usercard:i}})},clearCommentContentBuffer:function(){for(var b in this.aUgcCommentText){if(typeof(this.aUgcCommentText[b])=="string"&&this.aUgcCommentText[b].substring(0,17)!="ugccmt-comment-b_"){delete this.aUgcCommentText[b]}}},truncateText:function(d,c){var b=d;if(!a.Lang.isNull(d)&&!a.Lang.isUndefined(d)&&a.Lang.isString(d)){if(d.length>c){b=d.substring(0,c);b=b.replace(/\w+$/,"")+"..."}}return b},viewCommentsOnContextHandler:function(d){var i=d.context_id;var e="";d.context_description=this.truncateText(d.context_description,this.truncationLen);if(typeof(d.context_category)!="undefined"){e+="&context_category="+encodeURIComponent(d.context_category)}var h=a.one("#ugccmt-container");h.setContent("");if(!a.Lang.isNull(a.one("#ugccmt-container-b"))){a.one("#ugccmt-container-b").get("parentNode").removeChild(a.one("#ugccmt-container-b"))}var g="ugccmt-view-all-preloader";this.showPreloader(g,"ugccmt-view-all-preloader",h.get("parentNode"),"append");var c=this.aXHR.GET_CONTEXT_UUID+"&context_id="+i+"&"+Math.random();c+="&baseurl="+encodeURIComponent(d.context_url)+e;c+=this.bucket_publisher_id_url;function b(n,m,l){try{var k=a.JSON.parse(m.responseText);if(typeof k.data!="undefined"&&typeof k.data.context_id!="undefined"){d.context_id=k.data.context_id}this.viewCommentsOnUUIDContextHandler(d)}catch(j){this.viewCommentsOnUUIDContextHandler(d);a.io(l.argument.aXHR.ERR_LOG+"view comments on context parse problem&err_response_body="+escape(m.responseText)+"&catch_ms="+j);return}}function f(l,k,j){this.viewCommentsOnUUIDContextHandler(d);a.io(j.argument.aXHR.ERR_LOG+"view comments on context failed&err_response_body="+escape(k.responseText));return}a.io(c,{on:{success:b,failure:f},context:this,"arguments":{argument:this}})},onClickLocationSharePrefHandle:function(g){var d={};var e=g.get("parentNode");g=e.one("input.loc-share");if(a.Lang.isNull(g)){return}var h=g.get("checked");this.ult_track("c_clp",g);a.all(".loc-share").each(function(i){i.set("checked",h)});this.oUserLocation.is_sharelocation=h;d.is_sharelocation=this.oUserLocation.is_sharelocation;d.ycrumb=this.ycrumb;var c=this.aXHR.UPDATE_STATUS+"&context_id="+this.context_id+"&"+Math.random();c+="&baseurl="+encodeURIComponent(this.context_url);c+=this.bucket_publisher_id_url;function f(k,j,i){a.io(i.argument.aXHR.ERR_LOG+"onClickLocationSuccess&err_response_body="+escape(j.responseText))}function b(k,j,i){a.io(i.argument.aXHR.ERR_LOG+"onClickLocationFailure&err_response_body="+escape(j.responseText))}a.io(c,{on:{success:f,failure:b},method:"POST",data:d,context:this,"arguments":{argument:this}})},viewCommentsOnUUIDContextHandler:function(e){this.context_id=e.context_id;this.context_url=e.context_url;this.oVita.context_title=e.asset_title;var h="ugccmt-view-all-preloader";function c(m,l,j){if((typeof l.responseText!=="undefined")&&(l.responseText.trim().length!==0)){j.argument.removePreloader(h);var i=a.one("#ugccmt-container");i.setContent(l.responseText);j.argument.append_mycmt_tab();j.argument.renderPostFormMarkup(a.one("#ugccmt-post-frm-container"));j.argument.renderReplyLinks("ugccmt-container");j.argument.renderRateButton("ugccmt-container");if(!a.Lang.isNull(a.one("#ugccmt-post-frm"))){a.on("submit",j.argument.commentsPostSubmitListner,"#ugccmt-post-frm",j.argument,true);var k=a.one("#ugccmt-post-frm TEXTAREA.ugccmt-comments-post-field");a.on("keydown",j.argument.commentsPostKeyListner,k,j.argument,true);a.on("keyup",j.argument.commentsPostKeyListner,k,j.argument,true);a.on("focus",j.argument.commentsPostFocusListner,k,j.argument,true)}j.argument.ult_track("ctx_load",a.one("#yom-comments"));j.argument.disable_post_rate_btns();j.argument.loadDisclosure()}else{this.updatePreloader(h,j.argument.oL10n.SERVER_ERROR,j.argument.oL10n.ERR_LOAD_CNHDC_EMPTY);a.io(this.aXHR.ERR_LOG+j.argument.oL10n.ERR_LOAD_CNHDC_EMPTY+"&err_response_body="+escape(l.responseText));return}}function g(k,j,i){this.updatePreloader(h,i.argument.oL10n.REQUEST_FAILED,i.argument.oL10n.ERR_CMT_CTX_FAILURE);a.io(this.aXHR.ERR_LOG+i.argument.oL10n.ERR_CMT_CTX_FAILURE+"&err_response_body="+escape(j.responseText));return}var f="";var b="article";if(typeof(e.asset_title)!="undefined"){f+="&asset_title="+encodeURIComponent(e.asset_title)}if(typeof(e.context_category)!="undefined"){f+="&context_category="+encodeURIComponent(e.context_category)}if(typeof(e.context_description)!="undefined"){f+="&context_description="+encodeURIComponent(e.context_description)}if(typeof(e.context_screen_comments)!="undefined"){f+="&context_screen_comments="+encodeURIComponent(e.context_screen_comments)}if(typeof(e.ugccmt_vita_type)!="undefined"){f+="&ugccmt_vita_type="+encodeURIComponent(e.ugccmt_vita_type);b=encodeURIComponent(e.ugccmt_vita_type)}if(typeof(e.ugccmt_vita_expire_time)!="undefined"){f+="&ugccmt_vita_expire_time="+encodeURIComponent(e.ugccmt_vita_expire_time)}if(typeof(e.ugccmt_vita_update_varient)!="undefined"){f+="&ugccmt_vita_update_varient="+encodeURIComponent(e.ugccmt_vita_update_varient)}if(typeof(e.ugccmt_vita_update_transform)!="undefined"){f+="&ugccmt_vita_update_transform="+encodeURIComponent(e.ugccmt_vita_update_transform)}if(typeof(e.ugccmt_vita_latitude)!="undefined"){f+="&ugccmt_vita_latitude="+encodeURIComponent(e.ugccmt_vita_latitude)}if(typeof(e.ugccmt_vita_longitude)!="undefined"){f+="&ugccmt_vita_longitude="+encodeURIComponent(e.ugccmt_vita_longitude)}if(typeof(e.ugccmt_vita_img_url)!="undefined"){f+="&ugccmt_vita_img_url="+encodeURIComponent(e.ugccmt_vita_img_url)}if(typeof(e.ugccmt_vita_img_width)!="undefined"){f+="&ugccmt_vita_img_width="+encodeURIComponent(e.ugccmt_vita_img_width)}if(typeof(e.ugccmt_vita_img_height)!="undefined"){f+="&ugccmt_vita_img_height="+encodeURIComponent(e.ugccmt_vita_img_height)}if(typeof(e.ugccmt_vita_img_rights)!="undefined"){f+="&ugccmt_vita_img_rights="+encodeURIComponent(e.ugccmt_vita_img_rights)}if(b=="article"){if(typeof(e.ugccmt_vita_article_author)!="undefined"){f+="&ugccmt_vita_article_author="+encodeURIComponent(e.ugccmt_vita_article_author)}if(typeof(e.ugccmt_vita_article_source)!="undefined"){f+="&ugccmt_vita_article_source="+encodeURIComponent(e.ugccmt_vita_article_source)}}else{if(b=="photo"){if(typeof(e.ugccmt_vita_photo_album)!="undefined"){f+="&ugccmt_vita_photo_album="+encodeURIComponent(e.ugccmt_vita_photo_album)}if(typeof(e.ugccmt_vita_photo_album_url)!="undefined"){f+="&ugccmt_vita_photo_album_url="+encodeURIComponent(e.ugccmt_vita_photo_album_url)}}else{if(b=="video"){if(typeof(e.ugccmt_vita_video_date)!="undefined"){f+="&ugccmt_vita_video_date="+encodeURIComponent(e.ugccmt_vita_video_date)}}else{if(b=="blog"){if(typeof(e.ugccmt_vita_blog_type)!="undefined"){f+="&ugccmt_vita_blog_type="+encodeURIComponent(e.ugccmt_vita_blog_type)}if(typeof(e.ugccmt_vita_blog_post_title)!="undefined"){f+="&ugccmt_vita_blog_post_title="+encodeURIComponent(e.ugccmt_vita_blog_post_title)}if(typeof(e.ugccmt_vita_blog_post_url)!="undefined"){f+="&ugccmt_vita_blog_post_url="+encodeURIComponent(e.ugccmt_vita_blog_post_url)}if(typeof(e.ugccmt_vita_bolg_author)!="undefined"){f+="&ugccmt_vita_bolg_author="+encodeURIComponent(e.ugccmt_vita_bolg_author)}if(typeof(e.ugccmt_vita_bolg_author_post_url)!="undefined"){f+="&ugccmt_vita_bolg_author_post_url="+encodeURIComponent(e.ugccmt_vita_bolg_author_post_url)}}}}}var d=this.aXHR.GET_LIST+"&context_id="+this.context_id+"&"+Math.random();d+="&mode=list";d+="&show_form=yes";d+="&baseurl="+encodeURIComponent(this.context_url);d+="&"+f;d+=this.bucket_publisher_id_url;a.io(d,{on:{success:c,failure:g},context:this,"arguments":{argument:this}})},viewAllCommentsHandler:function(f){var e="ugccmt-view-all-preloader";function b(g,h,n){if((typeof h.responseText!=="undefined")&&(h.responseText.trim().length!==0)){var l=a.one("#ugccmt-container");l.setContent(h.responseText);var j=this;n.argument.append_mycmt_tab();n.argument.renderPostFormMarkup(a.one("#ugccmt-post-frm-container"));n.argument.renderReplyLinks("ugccmt-container");n.argument.renderRateButton("ugccmt-container");n.argument.disable_post_rate_btns();var m=a.one("#ugccmt-post-frm-container");j.markTcBlockActive();var p=m.one("img.ugccmt-avatar");if(!a.Lang.isNull(p)){if(n.argument.sUserImage!==""){p.setStyle("background","url("+n.argument.sUserImage+")")}}var k=m.one("div.ugccmt-hd");if(!a.Lang.isNull(k)){if(n.argument.sUserNickname!==""){k.setContent(n.argument.getUserMarkup());n.argument.initLocWidget(k)}}if(!a.Lang.isNull(a.one("#ugccmt-post-frm"))&&(!a.Lang.isNull(a.one("#ugccmt-post-frm")))){a.on("submit",n.argument.commentsPostSubmitListner,"#ugccmt-post-frm",n.argument,true);var i=a.one("#ugccmt-post-frm TEXTAREA.ugccmt-comments-post-field");a.on("keydown",n.argument.commentsPostKeyListner,i,n.argument,true);a.on("keyup",n.argument.commentsPostKeyListner,i,n.argument,true);a.on("focus",n.argument.commentsPostFocusListner,i,n.argument,true)}n.argument.renderEllipSizedBox("ugccmt-comments");a.on("scroll",this.scrollCalc,window,this,{custobj:a.one("#ugccmt-postcommentinternal")});document.location.href="#ugccmt-container"}else{this.updatePreloader(e,n.argument.oL10n.SERVER_ERROR,n.argument.oL10n.ERR_LOAD_ALL_CMT_EMPTY);a.io(this.aXHR.ERR_LOG+n.argument.oL10n.ERR_LOAD_ALL_CMT_EMPTY+"&err_response_body="+escape(h.responseText))}}function d(i,h,g){this.updatePreloader(e,g.argument.oL10n.REQUEST_FAILED,g.argument.oL10n.ERR_ALL_CMT_FAILURE);a.io(this.aXHR.ERR_LOG+g.argument.oL10n.ERR_ALL_CMT_FAILURE+"&err_response_body="+escape(h.responseText))}this.showPreloader(e,"ugccmt-view-all-preloader",f.get("parentNode"),"append");var c=this.aXHR.GET_LIST+"&context_id="+this.context_id+"&"+Math.random();c+="&ugccmtnav="+encodeURIComponent("v1/comments/context/"+this.context_id+"/comments?count="+this.sPerPage+"&sortBy="+this.sCurrentSortBy);c+="&mode=list&show_form=yes";c+="&baseurl="+encodeURIComponent(this.context_url);c+=this.bucket_publisher_id_url;a.io(c,{on:{success:b,failure:d},context:this,"arguments":{argument:this}})},viewMoreCommentsHandler:function(i){var j="";var d="";var f=false;var g="list";if(!a.Lang.isNull(a.one("#ugccmt-container-b"))&&a.one("#ugccmt-container-b").contains(i)){j+="-b";g="bubble"}if(!a.Lang.isNull(i.ancestor(".ugccmt-replies"))){f=true;d=i.get("id").split("_")[1];j+="_"+d}var c="ugccmt-view-more-preloader"+j;function e(q,p,m){try{var l=a.JSON.parse(p.responseText);if(typeof l.markup!="undefined"&&l.markup!==""){m.argument.removePreloader(c);var n=a.one("#ugccmt-comments"+j);n.setContent(n.getContent()+l.markup);if(typeof(l.more_url)!="undefined"){m.argument._render_MoreLink({more_url:l.more_url,more_lbl:l.pagination_msg,id_suffix:j})}if(!f&&g=="list"){m.argument._render_Total({total:l.total,total_msg:l.total_msg})}m.argument.renderReplyLinks("ugccmt-container");if(g=="bubble"){m.argument.renderRateButton("ugccmt-container-b");m.argument.renderEllipSizedBox("ugccmt-container-b")}else{m.argument.renderRateButton("ugccmt-container")}m.argument.disable_post_rate_btns();if(!a.Lang.isNull(a.one("#ugccmt-post-frm-container"))){a.one("#ugccmt-post-frm-container").setStyle("display","none");a.one("#ugccmt-post-frm-container").setStyle("display","")}m.argument.renderEllipSizedBox("ugccmt-container")}else{m.argument.updatePreloader(c,m.argument.oL10n.SERVER_ERROR,m.argument.oL10n.ERR_MORE_CMT_RSP_EMPTY);a.io(m.argument.aXHR.ERR_LOG+m.argument.oL10n.ERR_MORE_CMT_RSP_EMPTY+"&err_response_body="+escape(p.responseText))}}catch(k){m.argument.updatePreloader(c,m.argument.oL10n.SERVER_ERROR,m.argument.oL10n.ERR_MORE_CMT_RSP_INVALID);a.io(m.argument.aXHR.ERR_LOG+m.argument.oL10n.ERR_MORE_CMT_RSP_INVALID+"&err_response_body="+escape(p.responseText)+"&catch_ms="+k);return}}function h(m,l,k){k.argument.updatePreloader(c,k.argument.oL10n.REQUEST_FAILED,k.argument.oL10n.ERR_CMT_MORE_FAILURE);a.io(k.argument.aXHR.ERR_LOG+k.argument.oL10n.ERR_CMT_MORE_FAILURE+"&err_response_body="+escape(l.responseText))}this.showPreloader(c,"ugccmt-view-more-preloader",i,"append");var b;if(i.getAttribute("data-href").match(/method=user_activity/g)){b=this.aXHR.GET_USER_ACTV+"&context_id="+this.context_id+"&"+Math.random();b+="&ugccmtnav="+this.getQueryParam("ugccmtnav",i.getAttribute("data-href"));b+="&guid="+this.getQueryParam("guid",i.getAttribute("data-href"));b+="&mode="+g;b+="&baseurl="+encodeURIComponent(this.context_url)}else{b=this.aXHR.GET_LIST+"&context_id="+this.context_id+"&comment_id="+d+"&"+Math.random();b+="&ugccmtnav="+this.getQueryParam("ugccmtnav",i.getAttribute("data-href"));b+="&mode="+g;b+="&baseurl="+encodeURIComponent(this.context_url)}b+=this.bucket_publisher_id_url;a.io(b,{on:{success:e,failure:h},context:this,"arguments":{argument:this}})},viewReplyHandler:function(A){var z="";var n=A.get("id").split("_")[1];var p="list";var e=0;var h=A.ancestor(".ugccmt-comment");if(h){e=h.get("id").split("_")[2]||0}if(!a.Lang.isNull(a.one("#ugccmt-container-b"))&&a.one("#ugccmt-container-b").contains(A)){z+="-b";p="bubble"}if(p=="bubble"&&!a.Lang.isNull(a.one(".ugccmt-container-b div.ugccmt-flyw-trg"))){var y=a.one(".ugccmt-container-b div.ugccmt-flyw-trg").get("parentNode").get("id");delete this.aUgcCommentText[y]}z+="_"+n;var u="ugccmt-view-reply-preloader"+z;var q=A.get("parentNode").get("parentNode").get("parentNode");var s=q.one("div.ugccmt-replies");var w=false;if(!a.Lang.isNull(s)){if(s.hasClass("ugccmt-replies-loaded")){w=true}}function c(D,C,B){r(C.responseText||"",B)}function r(L,N){var B;var F=a.one("#ugccmt-replies"+z);if(!a.Lang.isNull(F)&&F.hasClass("ugccmt-replies-sec")){if((q._node.id!="ugccmt-comment"+z)){var G=q.get("parentNode").get("parentNode");q.get("parentNode").remove();q=G}else{F.remove()}}A.removeClass("ugccmt-disabled");if(L.trim().length!==0){N.argument.removePreloader(u);if(!a.Lang.isNull(a.one("#ugccmt-view-reply"+z))){a.one("#ugccmt-view-reply"+z).get("children").each(function(P){if(!a.Lang.isNull(P)&&P.hasClass("right_arrow")){P.replaceClass("right_arrow","down_arrow")}})}A.one("span").replaceClass("right_arrow","down_arrow");if(p=="bubble"&&typeof(s)!="undefined"&&!a.Lang.isNull(s)){s.get("parentNode").removeChild(s)}q.append('<div class="ugccmt-replies ugccmt-replies-loaded" id="ugccmt-replies'+z+'">'+L+"</div>");N.argument.renderPostFormMarkup(a.one("#ugccmt-post-frm-container"+z));if((!a.Lang.isNull(a.one("#ugccmt-post-frm-container"+z)))){if(p=="bubble"){N.argument.loadDisclosure()}else{var M=a.one("#ugccmt-post-frm-container"+z);var O=M.one("img.ugccmt-avatar");if(!a.Lang.isNull(O)){if(N.argument.sUserImage!==""){O.setStyle("background","url("+N.argument.sUserImage+")");var E=a.Node.create('<span class="ugccmt_change_picture"><a href="https://profile.yahoo.com/'+N.argument.myProfile.user_guid+'" target="_blank">Change</a></span>');if((/yimg\.com\/dh\/ap\/social\/profile\/profile_b48\.png/).test(N.argument.sUserImage)){E.addClass("ugccmt_change_picture_p")}O.insert(E,"after")}}var I=M.one("div.ugccmt-hd");if(!a.Lang.isNull(I)){if(N.argument.sUserNickname!==""){I.setContent(N.argument.getUserMarkup());N.argument.initLocWidget(I)}}}var H=a.one("#ugccmt-post-frm"+z);if(!a.Lang.isNull(H)&&!a.Lang.isNull(H)){a.on("submit",N.argument.commentsPostSubmitListner,H,N.argument,true)}var D=a.one("#ugccmt-post-frm-textarea"+z);if(!a.Lang.isNull(D)&&!a.Lang.isNull(D)){a.on("keydown",N.argument.commentsPostKeyListner,D,N.argument,true);a.on("keyup",N.argument.commentsPostKeyListner,D,N.argument,true);a.on("focus",N.argument.commentsPostFocusListner,D,N.argument,true)}}if(p=="bubble"){var C=parseInt(a.one("#ugccmt-total-replies"+z).getContent(),10);B='<span id="ugccmt-total-replies'+z+'" style="display:none" >'+C+"</span>";if(C>1){B+=N.argument.oL10n.COLLAPSE_REPLIES}else{B+=N.argument.oL10n.COLLAPSE_REPLY}A.setContent('<span class="ugccmt-sprite_bg down_arrow ugccmt-sprite_img"> </span>'+B)}if(p=="bubble"){N.argument.renderRateButton("ugccmt-container-b")}else{N.argument.renderRateButton("ugccmt-container")}N.argument.renderEllipSizedBox("ugccmt-replies"+z);N.argument.disable_post_rate_btns()}else{N.argument.updatePreloader(u,N.argument.oL10n.SERVER_ERROR,N.argument.oL10n.ERR_REPLY_RSP_EMPTY);a.io(N.argument.aXHR.ERR_LOG+N.argument.oL10n.ERR_REPLY_RSP_EMPTY+"&err_response_body="+escape(L))}var K=a.one("#ugccmt-container-b ul.ugccmt-replies-bubble");if(!a.Lang.isNull(K)){a.one("#ugccmt-container-b").removeChild(K);if((p=="bubble")&&(!a.Lang.isNull(a.one("#"+N.argument.bubbleCmtId)))&&!a.Lang.isNull(a.one("#"+N.argument.bubbleCmtId))){var J=a.one("#"+N.argument.bubbleCmtId+" div").get("className")+" ugccmt-comments-flyw-trg";a.one("#"+N.argument.bubbleCmtId+" div").addClass(J)}}}function j(D,C,B){A.removeClass("ugccmt-disabled");B.argument.updatePreloader(u,B.argument.oL10n.REQUEST_FAILED,B.argument.oL10n.ERR_REPLY_VIEW_FAILURE);a.io(B.argument.aXHR.ERR_LOG+B.argument.oL10n.ERR_REPLY_VIEW_FAILURE+"&err_response_body="+escape(C.responseText))}var f;if(w){var b=s.one("ul.ugccmt-comments");var k=s.one("div.ugccmt-post-frm");var x=s.one("div.ugccmt-navigation");var o;if(b.getStyle("display")=="block"){A.one("span").replaceClass("down_arrow","right_arrow");if(!a.Lang.isNull(b)){b.setStyle("display","none")}if(!a.Lang.isNull(x)){x.setStyle("display","none")}if(p=="list"&&!a.Lang.isNull(k)){k.setStyle("display","none")}if(p=="bubble"){o=parseInt(a.one("#ugccmt-total-replies"+z).getContent(),10);if(o>1){f='<span id="ugccmt-total-replies'+z+'" style="display:none" >'+o+"</span>"+a.substitute(this.oL10n.VIEW_ALL_REPLIES,{"0":o})}else{f='<span id="ugccmt-total-replies'+z+'" style="display:none" >'+o+"</span>"+a.substitute(this.oL10n.VIEW_ALL_REPLY,{"0":o})}A.setContent('<span class="ugccmt-sprite_bg right_arrow ugccmt-sprite_img"> </span>'+f)}}else{A.one("span").replaceClass("right_arrow","down_arrow");if(!a.Lang.isNull(b)){b.setStyle("display","block")}if(!a.Lang.isNull(x)){x.setStyle("display","block")}if(p=="list"&&!a.Lang.isNull(k)){k.setStyle("display","block")}if(p=="bubble"){o=parseInt(a.one("#ugccmt-total-replies"+z).getContent(),10);f='<span id="ugccmt-total-replies'+z+'" style="display:none" >'+o+"</span>";if(o>1){f+=this.oL10n.COLLAPSE_REPLIES}else{f+=this.oL10n.COLLAPSE_REPLY}A.setContent('<span class="ugccmt-sprite_bg down_arrow ugccmt-sprite_img"> </span>'+f)}var t=a.one("#ugccmt-post-frm-error-cntainer"+z);if(!a.Lang.isNull(t)){t.get("parentNode").removeChild(t)}}this.ioState=0}else{var g=this.isUserCommentsTab();if(e==0&&g){var d='<ul id="ugccmt-comments_'+n+'" class="ugccmt-comments"></ul><div class="ugccmt-post-frm"  id="ugccmt-post-frm-container_'+n+'"></div>';r(d,{argument:this});this.ioState=0}else{this.ult_track("c_reply",A);A.addClass("ugccmt-disabled");this.showPreloader(u,"ugccmt-reply-preloader",A.get("parentNode"),"append");var v=this.getContextInfo(A);var l=v.context_id;var i=this.aXHR.GET_LIST+"&context_id="+l+"&comment_id="+n+"&"+Math.random();var m="v1/comments/context/"+l+"/comment/"+n+"/replies?";m+="count="+this.sPerPage;i+="&ugccmtnav="+encodeURIComponent(m);i+="&mode="+p;if(this.sPostingDisabled){i+="&disposting=yes"}i+="&show_form=yes";i+="&baseurl="+encodeURIComponent(v.context_url);i+=this.bucket_publisher_id_url;a.io(i,{on:{success:c,failure:j},context:this,"arguments":{argument:this}})}}},checkCrumbReValidation:function(){if(this.reValidateCrumb===true){this.ycrumb="rcrumb";this.reValidateCrumb=false}},postCommentHandler:function(A){this.checkCrumbReValidation();var x="";var l="";var c=false;var m="list";if(!a.Lang.isNull(a.one("#ugccmt-container-b"))&&a.one("#ugccmt-container-b").contains(A)){x+="-b";m="bubble"}if(!a.Lang.isNull(A.ancestor(".ugccmt-replies"))){c=true;l=A.get("id").split("_")[1];x+="_"+l}var r="cmt-post-preloader"+x;var f=A._node.elements.submit;var p=(this.isExpert=="Expert")?"communityManager":"";function y(L,M,T){var i=[];A._node.elements.submit.disabled=false;try{i=a.JSON.parse(M.responseText)}catch(I){a.io(T.argument.aXHR.ERR_LOG+T.argument.oL10n.ERR_CMT_POST_INVALID+"&err_response_body="+escape(M.responseText)+"&catch_ms="+I);return}var C;if(typeof i.data.rcrumb!="undefined"){f.disabled=false;T.argument.removePreloader(r);T.argument.ycrumb=i.data.rcrumb;T.argument.postCommentHandler(A.get("id"))}else{if(i.status===true){f.disabled=false;T.argument.removePreloader(r);if(T.argument.sAllowScreening===true){var j;if(c){j=T.argument.oL10n.COMMENTS_REPLY_SUCESS_PRV_MSG_SCREEN}else{j=T.argument.oL10n.COMMENTS_POST_SUCESS_PRV_MSG_SCREEN}T.argument.ult_track("comment_post",A);if(a.Lang.isNull(A.get("parentNode").one("h2.ugccmt-post-success-msg-title"))){C=a.Node.create('<div id="ugccmt-comments-post-success'+x+'" class="ugccmt-comments-post-success-wraper ugccmt-msg"><div class="ugccmt-comments-post-success-msg">'+j+"</div></div>");A.insert(C,"before")}}else{var J="";var F="";var V=i.data.content;J="url("+T.argument.sUserImage+")";F=T.argument.sUserNickname;var B=i.data.self_id;var S="";if(T.argument.sAllowReply=="yes"){if(i.data.parent_id===""){S='<a id="ugccmt-view-reply_'+B+'" href="#" class="ugccmt-reply ugccmt-view-reply" rel="nofollow"><span class="ugccmt-sprite_bg right_arrow ugccmt-sprite_img"> </span><span id="ugccmt-total-replies_'+B+'"></span> '+T.argument.oL10n.REPLY_LINK_TXT+"</a></div>"}}var K="";if(T.argument.rating_type=="up_down"||T.argument.rating_type=="up"){K+='<em id="ugccmt-rate-pos_'+B+'" class="ugccmt-rating-positive ugccmt-rating-zero">0</em><span class="ugccmt-accessibility-invisible">'+T.argument.oL10n.USERS_LIKED_COMMENT+'</span><a rel="nofollow" href="#" class="ugccmt-sprite_bg ugccmt-sprite_img gray_thumb_up" id="ugccmt-rate-tu_'+B+'" title="'+T.argument.oL10n.THUMBS_UP+'">'+T.argument.oL10n.THUMBS_UP+"</a>"}if(T.argument.rating_type=="up_down"||T.argument.rating_type=="down"){K+='<a rel="nofollow" href="#" class="ugccmt-sprite_bg ugccmt-sprite_img gray_thumb_down" id="ugccmt-rate-td_'+B+'" title="'+T.argument.oL10n.THUMBS_DOWN+'">'+T.argument.oL10n.THUMBS_DOWN+'</a><em id="ugccmt-rate-neg_'+B+'" class="ugccmt-rating-negetive ugccmt-rating-zero">0</em><span class="ugccmt-accessibility-invisible">'+T.argument.oL10n.USERS_DISLIKED_COMMENT+"</span>"}var Q='<span class="ugccmt-bull">&nbsp;&#8226;&nbsp;</span>';if(typeof T.argument.oUserLocation.is_sharelocation!="undefined"&&T.argument.oUserLocation.is_sharelocation===true){var U=T.argument.oUserLocation.city+", "+T.argument.oUserLocation.ctry;if(typeof i.data.response!="undefined"&&typeof i.data.response.location!="undefined"&&typeof i.data.response.location.city!="undefined"){var R=i.data.response.location.city.split(",");if(R.length==4){if(T.argument.sCountryCode==R[3]){U=R[0]+", "+R[1]}else{U=R[0]+", "+R[2]}}}Q='<span class="ugccmt-bull">&nbsp;&#8226;&nbsp;</span> <a class="ugccmt-comment-location" href="#"><span class="'+T.argument.oUserLocation.woe+'">'+U+'</span></a> <span class="ugccmt-bull">&nbsp;&#8226;&nbsp;</span>'}var O='<div id="ugccmt-comment_'+B+'_0_0_0" class="ugccmt-comment"><div class="ugccmt-avatar-container"><a><img id="ugccmt-user_'+B+'" width="48" height="48" alt="'+F+'" src="https://s.yimg.com/os/mit/media/m/base/images/transparent-1093278.png" style="background:'+J+';"></a></div><div class="ugccmt-info"><div class="ugccmt-rate">'+K+'</div><cite><a id="ugccmt-user-guidn_'+this.current_User+'" target="_blank" href="https://profiles.yahoo.com" class="ugccmt-user-cmt"><strong>'+F+"</strong></a>"+Q+'<span class="ugccmt-timestamp"><abbr>'+T.argument.oL10n.A_SECOND_AGO+'</abbr></span><a class="ugccmt-remove-cmt" id="ugccmt-remove-cmt_'+B+'" href="#" rel="nofollow">'+T.argument.oL10n.REMOVE+'</a></cite><blockquote class="ugccmt-commenttext">'+V+"</blockquote>"+S+"</div>";C=a.Node.create('<li id="ugccmt-comment_'+B+'"></li>');C.setContent(O);var N=a.one("#ugccmt-comments"+x);if(c){N.append(C)}else{if(!a.Lang.isNull(N.get("firstChild"))){N.get("firstChild").insert(C,"before")}else{N.append(C)}}T.argument.ult_track("comment_post",A);var P=new a.Anim({node:"#ugccmt-comment_"+B,from:{backgroundColor:"#fef6e1"},to:{backgroundColor:"#fff"},easing:a.Easing.easeOut,duration:2});P.run();if(!c){T.argument._render_Total({total:i.data.total,total_msg:i.data.total_msg});N.setStyle("position","static");N.setStyle("position","relative")}}a.one("#ugccmt-post-frm-textarea"+x).set("value","");a.one("#ugccmt-post-frm-textarea"+x).focus();a.one("#ugccmt-post-frm-textarea"+x).setStyle("height","46px");var E=A.get("parentNode").one("div.ugccmt-comment-error");if((!a.Lang.isNull(E))&&(typeof l!="undefined")){E.get("parentNode").removeChild(E)}}else{if(i.status===false){f.disabled=false;T.argument.removePreloader(r);if(a.Lang.isNull(A.get("parentNode").one("div.ugccmt-comment-error"))){var H=a.Node.create('<div id="ugccmt-post-frm-error-cntainer'+x+'" class="ugccmt-comment-error"></div>');A.insert(H,"before")}var D='<div class=" ugccmt-sprite_bg cautionmetro16_1 ugccmt-sprite_img"></div>';D+='<span id="ugccmt-post-frm-error'+x+'"></span>';A.get("parentNode").one("div.ugccmt-comment-error").setContent(D);var G;if(typeof i.data.error=="undefined"){G=T.argument.oL10n.REQUEST_FAILED+" "+T.argument.oL10n.ERR_CMT_POST_EMPTY;a.one("#ugccmt-post-frm-error-cntainer"+x+" span").setContent(G)}else{G=i.data.error+" "+T.argument.oL10n.ERR_CMT_POST_INVALID;a.one("#ugccmt-post-frm-error-cntainer"+x+" span").setContent(G)}}}}}function n(D,C,i){A._node.elements.submit.disabled=false;a.io(i.argument.aXHR.ERR_LOG+i.argument.oL10n.ERR_CMT_POST_FAILURE+"&err_response_body="+escape(C.responseText));f.disabled=false;i.argument.removePreloader(r);if(a.Lang.isNull(a.one("#ugccmt-post-frm-error-cntainer"+x))){var j=a.Node.create('<div id="ugccmt-post-frm-error-cntainer'+x+'" class="ugccmt-comment-error"></div>');A.insert(j,"before")}var B='<div class=" ugccmt-sprite_bg cautionmetro16_1 ugccmt-sprite_img"> </div>';B+='<span id="ugccmt-post-frm-error'+x+'">'+i.argument.oL10n.REQUEST_FAILED+" "+i.argument.oL10n.ERR_CMT_POST_FAILURE+"</span>";a.one("#ugccmt-post-frm-error-cntainer"+x).setContent(B)}var w=/https?:\/\/(www\.)?[^.\s]+\.\S+/;var h=/www\.[^.\s]+\.\S+/;var q=/[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/i;var b=/[A-Z0-9]+\.(AERO|ARPA|ASIA|BIZ|CAT|COM|COOP|EDU|GOV|INFO|INT|JOBS|MIL|MOBI|NAME|NET|ORG|PRO|TEL|TRAVEL)(\s|\.|$)/i;var o=a.one("#ugccmt-post-frm-textarea"+x);var e=o.get("value");if(e.trim().length<1){if(a.Lang.isNull(a.one("#ugccmt-post-frm-error-cntainer"+x))){var k=a.Node.create('<div id="ugccmt-post-frm-error-cntainer'+x+'" class="ugccmt-comment-error"></div>');A.insert(k,"before")}var g='<div class="ugccmt-sprite_bg cautionmetro16_1 ugccmt-sprite_img"> </div>';g+='<span id="ugccmt-post-frm-error'+l+'">'+this.oL10n.PLZ_ENTER_COMMENT+"</span>";a.one("#ugccmt-post-frm-error-cntainer"+x).setContent(g)}else{if(w.test(e)||h.test(e)||q.test(e)||b.test(e)){if(a.Lang.isNull(a.one("#ugccmt-post-frm-error-cntainer"+x))){var k=a.Node.create('<div id="ugccmt-post-frm-error-cntainer'+x+'" class="ugccmt-comment-error"></div>');A.insert(k,"before")}var g='<div class="ugccmt-sprite_bg cautionmetro16_1 ugccmt-sprite_img"> </div>';g+='<span id="ugccmt-post-frm-error'+l+'">'+this.oL10n.ERR_URL_NOT_ALLOWED+"</span>";a.one("#ugccmt-post-frm-error-cntainer"+x).setContent(g)}else{A._node.elements.submit.disabled=true;var z={};if(typeof this.oUserLocation.is_sharelocation!="undefined"){z={latitude:this.oUserLocation.lat,longitude:this.oUserLocation.lon,city:this.oUserLocation.city+", "+this.oUserLocation.ctry,woe:this.oUserLocation.woe,is_checkin:this.oUserLocation.is_checkin,is_sharelocation:this.oUserLocation.is_sharelocation}}z.userType=p;z.cmt_text=a.one("#ugccmt-post-frm-textarea"+x).get("value");z.cmt_text=z.cmt_text.replace(/[<]/g,"%3C");z.cmt_text=z.cmt_text.replace(/[>]/g,"%3E");z.jurisdiction=this.sUserJurisdiction;z.ycrumb=this.ycrumb;z.total=this._getTotalCommentCount()+1;for(var v=0;v<A._node.elements.length;v++){var u=A._node.elements[v].id;if(u.substring(0,8)=="disc_101"){if(A._node.elements[v].type=="checkbox"&&A._node.elements[v].disabled===false&&A._node.elements[v].checked===true){z.networker=1;break}else{z.networker=0}}}f.disabled=true;this.showPreloader(r,"ugccmt-post-preloader",a.one(f),"insert");var d="";var t=this.getContextInfo(A);if(!a.Lang.isNull(A.ancestor(".ugccmt-replies"))){d=this.aXHR.POST_REPLY+"&context_id="+t.context_id+"&comment_id="+l}else{d=this.aXHR.POST_COMMENT+"&context_id="+this.context_id;for(var s in this.oVita){if(this.oVita.hasOwnProperty(s)){z[s]=this.oVita[s]}}}d+="&baseurl="+encodeURIComponent(t.context_url);d+=this.bucket_publisher_id_url;if(this.isUserCommentsTab()){z.via="userCommentsTab"}a.io(d,{on:{success:y,failure:n},method:"POST",form:{id:A.get("id")},data:z,context:this,"arguments":{argument:this}})}}},rateCommentsHandler:function(o){this.checkCrumbReValidation();var m=o.get("id").split("_");var n=this._isReply(o);var d=n[0];var l=m[1];var e=n[1];var j=this._isBubbleMode(o)?("-b_"+l):("_"+l);var f="thumbsUp";if(m[0]=="ugccmt-rate-td"||m[0]=="ugccmt-rate-td-b"){f="thumbsDown"}var c="";if(d){c=this.aXHR.RATE_REPLY;c+="&reply_id="+l+"&comment_id="+e}else{c=this.aXHR.RATE_COMMENT;c+="&comment_id="+l}var i=this.getContextInfo(o);var h=i.context_id;c+="&context_id="+h;c+="&baseurl="+encodeURIComponent(i.context_url);c+=this.bucket_publisher_id_url;var k=a.Array.indexOf(this.xhrUrlQueue,c);if(k>=0){return}else{this.xhrUrlQueue.push(c)}var b="ugccmt-comment-rate-preloader"+j;this.showPreloader(b,"ugccmt-rating-preloader",o.get("parentNode").get("firstChild"),"insert");function q(v,u,t){try{var s=a.JSON.parse(u.responseText);if(typeof s.rcrumb!="undefined"){this.removeElementInArray(this.xhrUrlQueue,c);t.argument.ycrumb=s.rcrumb;t.argument.rateCommentsHandler(o);return}if((s.status===true)||(s.status===false&&(parseInt(s.info.http_code,10)==400))){if(s.status===false&&(parseInt(s.info.http_code,10)==400)){a.io(t.argument.aXHR.ERR_LOG+t.argument.oL10n.ERR_RATE_ALREADY+"&err_response_body="+escape(u.responseText))}}else{if(s.status===false&&typeof s.info!="undefined"&&typeof s.info.message!="undefined"&&parseInt(s.info.http_code,10)!=400){a.io(t.argument.aXHR.ERR_LOG+t.argument.oL10n.ERR_CMT_RATE_REJECT+"&err_response_body="+escape(u.responseText))}}}catch(r){a.io(t.argument.aXHR.ERR_LOG+t.argument.oL10n.ERR_RATE_RSP_INVALID+"&err_response_body="+escape(u.responseText)+"&catch_ms="+r)}}function g(t,s,r){a.io(r.argument.aXHR.ERR_LOG+r.argument.oL10n.ERR_CMT_RATE_FAILURE+"&err_response_body="+escape(s.responseText))}function p(w,s){s.argument.removePreloader(b);var r=(f=="thumbsDown")?"ugccmt-rate-neg"+j:"ugccmt-rate-pos"+j;var u=a.one("#"+r);var t=parseInt(u.getContent(),10);var v="";if(f=="thumbsUp"){u.replaceClass("ugccmt-rating-zero","ugccmt-voted");a.one("#ugccmt-rate-tu"+j).replaceClass("blue_thumb_up","green_thumb_up_nobr");a.one("#ugccmt-rate-td"+j).replaceClass("blue_thumb_down","gray_thumb_down");v="c_tu"}else{u.replaceClass("ugccmt-rating-zero","ugccmt-voted-neg");a.one("#ugccmt-rate-tu"+j).replaceClass("blue_thumb_up","gray_thumb_up");a.one("#ugccmt-rate-td"+j).replaceClass("blue_thumb_down","red_thumb_down_nobr");v="c_td"}a.one("#ugccmt-rate-pos"+j).setStyle("display","block");u.setStyle("display","block");u.setContent(t+1);this.removeElementInArray(this.xhrUrlQueue,c);this.ult_track(v,o)}a.io(c,{on:{success:q,failure:g,end:p},method:"POST",data:{rating_value:f,ycrumb:this.ycrumb,via:(this.isUserCommentsTab()?"userCommentsTab":"")},context:this,"arguments":{argument:this}})},askremoveCmtHandler:function(c){var b=a.Node.create('<span class="ugccmt-delete-confirm">'+this.oL10n.ARE_YOU_SURE+"</span>");c.insert(b,"before");c.setContent(this.oL10n.YES);c.replaceClass("ugccmt-remove-cmt","ugccmt-delete-cmt");var d=a.Node.create('<a href="#" class="ugccmt-cancle-delete-cmt"></a>');d.setContent(this.oL10n.NO);c.insert(d,"after")},cancleremoveCmtHandler:function(d){var c=d.get("parentNode");var e=c.one("span.ugccmt-delete-confirm");c.removeChild(e);var b=c.one("a.ugccmt-delete-cmt");b.setContent(this.oL10n.REMOVE);b.replaceClass("ugccmt-delete-cmt","ugccmt-remove-cmt");c.removeChild(d)},removeCmtHandler:function(s){this.checkCrumbReValidation();var r="";var i=s.get("id").split("_")[1];var p="";var b=false;var j="list";var l=s.ancestor(".ugccmt-info").get("parentNode");var f=l.one("cite");var h=l.one("div.ugccmt-rate");var g=l.one("div.ugccmt-avatar-container");var k=l.one("blockquote.ugccmt-commenttext");if(!a.Lang.isNull(a.one("#ugccmt-container-b"))&&a.one("#ugccmt-container-b").contains(s)){r+="-b";j="bubble"}r+="_"+i;if(this.isUserCommentsTab()){if(s.ancestor(".ugccmt-replies")){b=true;var c=this.getSelfInfo(s);p=c.comment_id}}else{var d=s.ancestor(".ugccmt-replies");if(!a.Lang.isNull(d)){b=true;p=d.get("id").split("_")[1]}}var m="cmt-delete-preloader"+r;function n(z,y,v){try{var u=a.JSON.parse(y.responseText);if(typeof u.status!="undefined"){if(typeof u.rcrumb!="undefined"){v.argument.removePreloader(m);v.argument.ycrumb=u.rcrumb}else{if(u.status===true){s.get("parentNode").removeChild(s);var w=l.one(".ugccmt-view-reply");if(w){w.remove()}f.get("parentNode").removeChild(f);h.get("parentNode").removeChild(h);g.get("parentNode").removeChild(g);k.setContent(v.argument.oL10n.COMMENT_REMOVED);k.addClass("ugccmt-commenttext-lable")}else{v.argument.updatePreloader(m,u.error);a.io(v.argument.aXHR.ERR_LOG+v.argument.oL10n.ERR_DELETE_RSP_EMPTY+"&err_response_body="+escape(y.responseText))}}}else{v.argument.updatePreloader(m,v.argument.oL10n.SERVER_ERROR,v.argument.oL10n.ERR_DELETE_RSP_EMPTY);a.io(v.argument.aXHR.ERR_LOG+"Server_Error&err_response_body="+escape(y.responseText))}}catch(t){v.argument.updatePreloader(m,v.argument.oL10n.SERVER_ERROR,v.argument.oL10n.ERR_DELETE_RSP_INVALID);a.io(v.argument.aXHR.ERR_LOG+v.argument.oL10n.ERR_DELETE_RSP_INVALID+"&err_response_body="+escape(y.responseText)+"&catch_ms="+t)}}function q(v,u,t){t.argument.updatePreloader(m,t.argument.oL10n.REQUEST_FAILED,t.argument.oL10n.ERR_CMT_DELETE_FAILURE);a.io(t.argument.aXHR.ERR_LOG+t.argument.oL10n.ERR_CMT_DELETE_FAILURE+"&err_response_body="+escape(u.responseText))}this.ult_track("c_delete",s);this.showPreloader(m,"ugccmt-abuse-preloader",s.get("parentNode"),"append");var e="";if(b){e=this.aXHR.DELETE_REPLY;e+="&reply_id="+i;e+="&comment_id="+p}else{e=this.aXHR.DELETE_COMMENT;e+="&comment_id="+i}var o=this.getContextInfo(s);e+="&context_id="+o.context_id;e+=this.bucket_publisher_id_url;e+="&baseurl="+encodeURIComponent(o.context_url);a.io(e,{on:{success:n,failure:q},method:"POST",data:{ycrumb:this.ycrumb},context:this,"arguments":{argument:this}})},removeAbuseMarkup:function(c){if(c){c.preventDefault()}var b=a.one(".ugccmt-rpt-abuse-thx-blk");if(!a.Lang.isNull(b)){b.remove()}},stripslashes:function(b){b=b.replace(/\\'/g,"'");b=b.replace(/\\"/g,'"');b=b.replace(/\\\\/g,"\\");b=b.replace(/\\0/g,"\0");return b},createAbuseMarkup:function(l,r,m,n){var k=this;if(typeof this.timeout_handler!="undefined"&&this.timeout_handler){window.clearTimeout(this.timeout_handler)}var q=a.substitute(this.oL10n.DEAR_USER,{"0":this.sUserNickname});var j=a.substitute(this.stripslashes(this.oL10n.HUMAN_MODERATION_MESSAGE),{"0":""});var b="";if(this.sReportAbuseGuideLineUrl){b=this.sReportAbuseGuideLineUrl}var o=a.substitute(this.stripslashes(this.oL10n.THANK_YOU_FOR_CONTACTING_YAHOO),{"0":b});m=(typeof m=="undefined"&&this.target)?this.target:m;n=(typeof n=="undefined"&&this.type)?this.type:n;if(l!==null&&typeof l!="string"){l.preventDefault()}var p=a.Node.create('<div class="ugccmt-rpt-abuse-thx-blk"></div>');this.target=m;var f=this;switch(n){case"thanks":this.removeAbuseMarkup();p.setContent("<h3>"+this.oL10n.THANK_YOU+"</h3><div class='ugccmt-rpt-abuse-thx-blk1'>"+q+"</div><div class='ugccmt-rpt-abuse-thx-blk2'>"+this.oL10n.SUBMISION_SUCCESSFULL+"</div> <div class='ugccmt-rpt-abuse-thx-blk3'>"+o+"</div> <div class='ugccmt-rpt-abuse-thx-blk4'>"+j+"</div>");this.target.appendChild(p);this.target=m;this.type="category";this.timeout_handler=window.setTimeout(function(){f.removeAbuseMarkup()},this.sReportAbuseDisapperTime);break;case"category":this.removeAbuseMarkup();p.setContent('<div class="ugccmt-rpt-abuse-cat-blk-title">'+this.oL10n.ABUSE_TYPE_MESSAGE+' <span>*</span>:</div>  <FORM action="" method="post" name="abuse_cat">    <div class="ugccmt-rpt-abuse-cat-blk" id="ugccmt-rpt-abuse-cat-blk">      <label for="impersonation"><INPUT type="radio" name="category" id="impersonation" value="harm to minors" />'+this.oL10n.IMPERSONATION_RADIO_BTN_TXT+' </label>      <label for="harassment"> <INPUT type="radio" name="category" id="harassment" value="harassment" />'+this.oL10n.HARASSMENT_RADIO_BTN_TXT+'</label>      <label for="obscenity"> <INPUT type="radio" name="category" id="obscenity" value="obscenity" />'+this.oL10n.OBSCENITY_RADIO_BTN_TXT+' </label>      <label for="derogatory"> <INPUT type="radio" name="category" id= "derogatory" value="derogatory language">'+this.oL10n.DEROGATORY_RADIO_BTN_TXT+'</label>      <label for="spam"> <INPUT type="radio" name="category" id= "spam" value="spam">'+this.oL10n.SPAM_RADIO_BTN_TXT+'</label>      <label for="other"> <INPUT type="radio" name="category" id="other" value="other" />'+this.oL10n.OTHER_RADIO_BTN_TXT+' </label>    </div>    <div class="ugccmt-cat-des"></div>    <div class="clearfix">      <button id="cancel" type="submit" name="cancel" >'+this.oL10n.CANCEL_BTN_MESSAGE+'</button>      <button id="report" type="submit" disabled="disabled" name="submit" class="disabled">'+this.oL10n.REPORT_BTN_MESSAGE+"</button>    </div>  </FORM></div>");this.target.appendChild(p);this.target=m;a.all("#ugccmt-rpt-abuse-cat-blk input").each(function(e){a.on("change",k.AbuseMapping,e,k,true)});this.type="category_post";a.on("click",this.createAbuseMarkup,"#report",this,true);a.on("click",this.removeAbuseMarkup,"#cancel",this,true);a.on("keyup",this.enableRabuseBtn,"#ugccmt-abuse-cat-other-txt",this,true);break;case"category_post":var d={};for(var h=0;h<document.abuse_cat.category.length;h++){if(document.abuse_cat.category[h].checked===true){var c=document.abuse_cat.category[h].id;var g=document.abuse_cat.category[h].value;if(c=="other"){d.reason="other:"+a.one(".ugccmt-abuse-cat-other").get("value")}else{if(c=="impersonation"){d.reason=g}else{d.reason=c}}}}this.abuse_post_data=d;this.type="category_thx";this.reportAbuseHandler();break;case"category_thx":if(typeof this.timeout_handler!="undefined"&&this.timeout_handler){window.clearTimeout(this.timeout_handler)}if(!a.Lang.isNull(a.one(".ugccmt-rpt-abuse-thx-blk"))){a.one(".ugccmt-rpt-abuse-thx-blk").setContent("<h3>"+this.oL10n.THANK_YOU+"</h3><div class='ugccmt-rpt-abuse-thx-blk1'>"+q+"</div><div class='ugccmt-rpt-abuse-thx-blk2'>"+this.oL10n.SUBMISION_SUCCESSFULL+"</div> <div class='ugccmt-rpt-abuse-thx-blk3'>"+o+"</div>")}this.timeout_handler=window.setTimeout(function(){f.removeAbuseMarkup()},this.sReportAbuseDisapperTime);break}},enableRabuseBtn:function(d){var b=d.target;var c=a.one("#report");if(b.get("value")){c.removeAttribute("disabled");c.removeClass("disabled")}else{c.setAttribute("disabled","disabled");c.addClass("disabled")}},AbuseMapping:function(h,f,c){var g={harassment:this.oL10n.HARASSMENT_MESSAGE,obscenity:this.oL10n.SEXEUALLY_AND_OFFENSIVE_MESSAGE,derogatory:this.oL10n.THREAT_OF_VIOLENCE_MESSAGE,impersonation:"",spam:this.oL10n.SPAM_MESSAGE,other:'<input class="ugccmt-abuse-cat-other" id="ugccmt-abuse-cat-other-txt" type="text" />'};this.abuse_cat=g;var i=h.target;a.one(".ugccmt-cat-des").setContent(g[i.get("id")]);var d=a.one("#report");var b=a.one("#ugccmt-abuse-cat-other-txt");if(i.get("id")!="other"||(b!==null&&b.get("value"))){d.removeAttribute("disabled");d.removeClass("disabled")}else{d.setAttribute("disabled","disabled");d.addClass("disabled")}},reportAbuseHandler:function(m){var k=this;this.checkCrumbReValidation();var q={};var e="";if(m){this.old_target=m;q=this.parent_node=m.get("parentNode").get("parentNode")}else{m=this.old_target;q=this.parent_node;e=this.type}if(this.sReportAbuseByCategory=="yes"&&typeof this.abuse_post_data=="undefined"){this.createAbuseMarkup("","",m.get("parentNode").get("parentNode"),"category");return}this.comment_id=m.get("id").split("_")[1];var d=m.get("id").split("_")[1];var j="list";var o="";if(!a.Lang.isNull(a.one("#ugccmt-container-b"))&&a.one("#ugccmt-container-b").contains(m)){o+="-b";j="bubble"}o+="_"+d;var g=m.ancestor(".ugccmt-comment");if(!a.Lang.isNull(g)){this.is_reply=false}if(this.isUserCommentsTab()){if(m.ancestor(".ugccmt-replies")){this.is_reply=true;var p=this.getSelfInfo(m);this.parent_comment_id=p.comment_id;this.comment_id=p.reply_id}}else{g=m.ancestor(".ugccmt-replies");if(!a.Lang.isNull(g)){this.is_reply=true;this.parent_comment_id=g.get("id").split("_")[1];this.comment_id=m.get("id").split("_")[1]}}var c="cmt-abuse-preloader"+o;this.showPreloader(c,"ugccmt-abuse-preloader",m.get("parentNode"),"append");var b="";if(this.is_reply){b=this.aXHR.REPORT_ABUSE_REPLY;b+="&reply_id="+this.comment_id;b+="&comment_id="+this.parent_comment_id}else{b=this.aXHR.REPORT_ABUSE_COMMENT;b+="&comment_id="+this.comment_id}var h=this.getContextInfo(m);var i=h.context_id;b+="&context_id="+i;b+=this.bucket_publisher_id_url;var l={};l.ycrumb=this.ycrumb;if(typeof this.abuse_post_data!="undefined"){l.reason=this.abuse_post_data.reason}if(this.isUserCommentsTab()){l.via="userCommentsTab"}function f(u,t){try{var s=a.JSON.parse(t.responseText);if(typeof s!="undefined"&&typeof s.status!="undefined"){if(typeof s.rcrumb!="undefined"){k.removePreloader(c);k.ycrumb=s.rcrumb;k.reportAbuseHandler(m)}else{if(s.status===true){if(k.sReportAbuseByCategory!="yes"&&e!="category_thx"){k.createAbuseMarkup("","",q,"thanks")}else{k.createAbuseMarkup("","",q,"category_thx")}if(m.get("parentNode")!==null){m.get("parentNode").removeChild(m)}k.updatePreloader(c,s.info.message);a.io(k.aXHR.ERR_LOG+"Json_response&err_response_body="+escape(t.responseText));a.one("#"+c).setStyle("display","block");a.one("#"+c).setStyle("padding-left","0px")}else{k.updatePreloader(c,s.error);a.io(k.aXHR.ERR_LOG+"Json_response_error_message&err_response_body="+escape(t.responseText))}}}else{k.updatePreloader(c,k.oL10n.SERVER_ERROR,k.oL10n.ERR_RPOT_ABS_RSP_EMPTY);a.io(k.aXHR.ERR_LOG+k.oL10n.ERR_RPOT_ABS_RSP_EMPTY+"&err_response_body="+escape(t.responseText))}}catch(r){k.updatePreloader(c,k.oL10n.SERVER_ERROR,k.oL10n.ERR_RPOT_ABS_RSP_INVALID);a.io(k.aXHR.ERR_LOG+k.oL10n.ERR_RPOT_ABS_RSP_INVALID+"&err_response_body="+escape(t.responseText)+"&catch_ms="+r)}}function n(s,r){k.updatePreloader(c,k.oL10n.REQUEST_FAILED,k.oL10n.ERR_RPOT_ABS_FAILURE);a.io(k.aXHR.ERR_LOG+k.oL10n.ERR_RPOT_ABS_FAILURE+"&err_response_body="+escape(r.responseText))}a.io(b,{on:{success:f,failure:n},method:"POST",data:l,context:this})},inlineLoginHandler:function(e,c){var f=this;var b=e.get("id").split("_")[1];var d="";if(b=="facebook"){d=this.aXHR.LOGIN+"&ugccmtprop=facebook"}else{if(b=="google"){d=this.aXHR.LOGIN+"&ugccmtprop=google"}else{if(b=="yahoo"){d=this.aXHR.LOGIN+"&ugccmtprop=yahoo"}}}d+=this.bucket_publisher_id_url;if(f.oLoginWindow===null||f.oLoginWindow.closed===true){f.oLoginWindow=window.open(d,"mywindow","menubar=1, resizable=1,width=650,height=400")}if(typeof(f.oOverlayContainer)!="undefined"&&typeof(f.oOverlayContainer.logout)!="undefined"){f.oOverlayContainer.logout.hide()}f.disable_post_rate_btns();if(f.oInlineLoginCheckHandler===null){f.loginStatus="no";f.disClosureLoader="false";f.disclosureLoadLast=new Date().getTime();f.oInlineLoginCheckHandler=window.setInterval(function(){if(f.oLoginWindow.closed===true&&f.disClosureLoader=="false"){f.disClosureLoader="active";f.loadDisclosure()}if(f.oLoginWindow.closed===true&&f.disClosureLoader=="end"){a.all("div.ugccmt-post-button-wrapper").each(function(g){if(g.one("a.ugccmt-post-as-button-disable")!==null&&typeof(g.one("a.ugccmt-post-as-button-disable")!="undefined")){g.one("a.ugccmt-post-as-button-disable").replaceClass("ugccmt-post-as-button-disable","ugccmt-post-as-button")}});f.enable_rating_buttons();f.disClosureLoader="false";window.clearInterval(f.oInlineLoginCheckHandler);f.oInlineLoginCheckHandler=null}if((new Date().getTime()-f.disclosureLoadLast)>=360000){a.all("div.ugccmt-post-button-wrapper").each(function(g){if(g.one("a.ugccmt-post-as-button-disable")!==null&&typeof(g.one("a.ugccmt-post-as-button-disable")!="undefined")){g.one("a.ugccmt-post-as-button-disable").replaceClass("ugccmt-post-as-button-disable","ugccmt-post-as-button")}});f.enable_rating_buttons()}},200)}},enable_rating_buttons:function(){a.all("#yom-comments div.ugccmt-rate").each(function(b){b.all("a").each(function(c){c.removeClass("gray_thumb_up_tmp");c.removeClass("gray_thumb_down_tmp")})})},append_mycmt_tab:function(){if(this.user_guid!==""){var b=a.one("#ugccmt-container ul.ugccmt-tab-fltr");if(!a.Lang.isNull(b)){var c=a.one("#ugccmt-fltr-my");if(!a.Lang.isNull(c)){c.remove()}c=a.Node.create('<li id="ugccmt-fltr-my" class="ugccmt-fltr" ><a class="ugccmt-fltr-link" rel="nofollow" href="#">'+this.oL10n.MY_COMMENTS+"</a></li>");b.appendChild(c)}}},renderRemoveReportAbuse:function(g){var b=a.all("#"+g+" span.ugccmt-timestamp");for(var d=0;d<b._nodes.length;d++){var e=a.one(b._nodes[d]).get("parentNode");var h=a.one(b._nodes[d]).get("parentNode").get("parentNode").previous().one("img");var k=h.get("parentNode").get("parentNode").get("parentNode").get("parentNode").get("id").split("_")[1];var l=h.get("id").split("_")[2];var f=e.one(".abuse");if(this.user_guid!=l){var c=a.Node.create('<a href="#" rel="nofollow" id="ugccmt-report-abuse_'+k+'" class="abuse">'+this.oL10n.REPORT_ABUSE+"</a>");if(f!==null){e.replaceChild(c,f)}else{e.appendChild(c)}}if(this.user_guid!==""&&this.user_guid==l&&(g!="ugccmt-container-b")){var j=a.Node.create('<a href="#" rel="nofollow" id="ugccmt-remove-cmt_'+k+'" class="ugccmt-remove-cmt">'+this.oL10n.REMOVE+"</a>");if(f!==null){e.replaceChild(j,f)}else{e.appendChild(j)}}}},sliceNodeList:function(c,h,g){if(h<0){h=0}var f=[];var b=c._nodes.slice(h,g);var e=b.length;for(var d=0;d<e;d++){f.push(b[d].id.split("_")[1])}return f.join(",")},_getTrackingParam:function(s,r){var o=s;if(!a.Lang.isNull(r.ancestor(".ugccmt-replies"))){switch(o){case"c_more":s="r_more";break;case"c_abuse":s="r_abuse";break;case"c_expand":s="r_expand";break;case"c_unhide":s="r_unhide";break;case"comment_post":s="r_post";break;case"c_tu":s="r_tu";break;case"c_td":s="r_td";break;case"c_delete":s="r_delete";break;case"c_fl":s="r_fl";break;case"c_cl":s="r_cl";break;case"c_clp":s="r_clp";break}}switch(o){case"s_highestRated":s="s_popular";break;case"s_mostReplied":s="s_mreplied";break}var n=a.clone(this.tracking);n.act=s;n.hcid=this.context_id;n.cf=this.sCurrentFltrBy;n.rs=this.sCurrentSortByReply;n.ugcw="comment";if(o=="c_cl"){n.city=this.oUserLocation.city+", "+this.oUserLocation.ctry}if(o=="c_fl"||o=="f_loc"){n.city=this.sFltrCity}if(o=="c_clp"){n.lsp=(this.oUserLocation.is_sharelocation)?1:0}if(this.sCurrentSortBy=="highestRated"){n.cs="popular"}else{if(this.sCurrentSortBy=="mostReplied"){n.cs="mreplied"}else{n.cs=this.sCurrentSortBy}}var g;var b;var m;var c;var h;var q;var k;switch(s){case"ctx_load":case"flw_all":break;case"load":case"flw_load":if(this.tracking_vreason!==""){n.vreason=this.tracking_vreason}break;case"f_all":case"f_share":case"f_my":case"f_loc":case"s_popular":case"s_latest":case"s_oldest":case"s_mreplied":case"c_start":case"comment_post":case"c_cl":case"c_clp":q=a.all("#ugccmt-comments>li");h=q._nodes.length;n.cc=h;n.sb=this.sliceNodeList(q,0,5);break;case"c_end":case"c_more":q=a.all("#ugccmt-comments>li");h=q._nodes.length;n.cc=h;n.sa=this.sliceNodeList(q,(h-5),h);break;case"c_tspent":q=a.all("#ugccmt-comments>li");h=q._nodes.length;n.cc=h;n.tspent=this.getCmtTimeSpent();break;case"c_delete":case"c_abuse":case"c_tu":case"c_td":case"c_unhide":case"c_expand":case"c_reply":case"c_fl":b=r.ancestor("li");if(b!==null){if(!a.Lang.isNull(b.get("parentNode"))){q=b.get("parentNode").all(">li");m=b.get("id").split("_")[1];g=q.indexOf(b);h=q._nodes.length;n.cid=m;n.cp=g;n.cc=h;n.sa=this.sliceNodeList(q,(g-5),g);n.sb=this.sliceNodeList(q,g,(g+5))}}break;case"r_more":case"r_post":case"r_cl":case"r_clp":b=r.ancestor("li");if(!a.Lang.isNull(b.get("parentNode"))){q=b.get("parentNode").all(">li");m=b.get("id").split("_")[1];g=q.indexOf(b);h=q._nodes.length;k=b.all("ul>li");c=k._nodes.length;n.cid=m;n.cp=g;n.cc=h;n.rc=c;n.sa=this.sliceNodeList(k,(c-5),c)}break;case"r_delete":case"r_abuse":case"r_tu":case"r_td":case"r_unhide":case"r_expand":case"r_fl":var f=r.ancestor("li");if(f!==null&&f.get("parentNode")!==null){k=f.get("parentNode").all(">li");var i=f.get("id").split("_")[1];var d=k.indexOf(f);c=k._nodes.length;b=f.ancestor("li");q=b.get("parentNode").all(">li");m=b.get("id").split("_")[1];g=q.indexOf(b);h=q._nodes.length;n.cid=m;n.cp=g;n.cc=h;n.rid=i;n.rp=d;n.rc=c;n.sa=this.sliceNodeList(k,(c-5),c);n.sb=this.sliceNodeList(k,d,(d+5))}break;case"c_sconverse":n.sec="cvrs-cmmt";n.slk="btn";n.ltxt="start";n.itc=1;n.ct=this.oVita.vita_type;n.act="cnv-start-link";break}if(s=="comment_post"||s=="r_post"||s=="c_tu"||s=="r_tu"){var p=[];var e=a.one("#yom-comments #disc_100_0");if(!a.Lang.isNull(e)){if(e.get("checked")){p.push("y")}}var j=a.one("#yom-comments #disc_101_0");if(!a.Lang.isNull(j)){if(j.get("checked")){p.push("f")}}var l=a.one("#yom-comments #disc_102_0");if(!a.Lang.isNull(l)){if(l.get("checked")){p.push("t")}}n.ds=p.join(",")}return n},ult_track:function(c,f){var d=this._getTrackingParam(c,f);var b=parseInt(this._getTotalCommentCount(),10);var e=false;if(((!isNaN(b))&&b<1&&(a.Lang.isNull(this.bubbleCmtId)))||(isNaN(b)&&(a.Lang.isNull(this.bubbleCmtId)))){switch(d.act){case"load":case"c_tspent":case"c_start":case"c_end":e=true;break}}if(YAHOO&&YAHOO.Media&&YAHOO.Media.Tracking&&(e===false)){if(!this.yMediaTracking||!this.yMediaTracking.beacon){var g=d._S?d._S:0;this.yMediaTracking=new YAHOO.Media.Tracking({conf:{spaceid:g}})}if(typeof this.yMediaTracking.beacon==="function"){if(this.enableRapidTracking==1){a.Global.fire("rapid-tracker:click",{data:{sec:d.sec,linkname:d.slk,pos:d.cp,keys:d}})}else{this.yMediaTracking.beacon(d)}}}},isGoodTarget:function(g,c,e){var f=1;var b=false;while(g.get("nodeName")=="#text"){g=g.get("parentNode")}while(!b&&f<=e&&(typeof g.get("id")!="undefined")){for(var d=0;d<c.length;d++){if(g.get("id")==c[d]||g.hasClass(c[d])){b=true;break}}if(!b){g=g.get("parentNode")?g.get("parentNode"):false;f++}}if(typeof g.get("id")=="undefined"){return false}if(b){return g}else{return false}},getQueryParam:function(d,c){if(c===""){c=window.location.href}var b="[\\?&]"+d+"=([^&#]*)";var f=new RegExp(b);var e=f.exec(c);if(e===null){return false}else{return e[1]}},showPreloader:function(f,e,b,c){var d=a.one("#"+f);if(a.Lang.isNull(d)){d=a.Node.create('<span id="'+f+'" class="'+e+'" style="display:inline;">&nbsp;&nbsp;</span>');if(c=="insert"){b.insert(d,"before")}else{if(c=="append"){b.append(d)}}}else{d.setContent("&nbsp;&nbsp;");d.setStyle("display","inline")}},updatePreloader:function(e,c,b){var d=a.one("#"+e);if(!a.Lang.isNull(d)){if(typeof b!="undefined"&&b!==null&&b!==""){c=c+"&nbsp;"+b+"&nbsp;"}d.setContent(c);d.setStyle("background","none")}},removePreloader:function(c){var b=a.one("#"+c);if(!a.Lang.isNull(b)){b.remove()}},showLocationHelp:function(d){var c=this;var b='<div style="padding:12px;"><div class="ugccmt-sprite_bg ugccmt-loc-help-close"></div><span><p>'+c.oL10n.LOCATION_TOOLTIP+"</p></span></div>";this.showInfoOverlay(d,b);a.on("click",function(){c.hideInfoOverlay()},".ugccmt-loc-help-close",this,true)},showInfoOverlay:function(e,c){if(typeof this.oOverlayContainer.info=="undefined"){if(a.UA.ie){this.oOverlayContainer.info=new a.Overlay({visible:false,width:"260px",zIndex:1000,constrain:false})}else{var d=this.getAnimPlugin();this.oOverlayContainer.info=new a.Overlay({visible:false,width:"260px",zIndex:1000,constrain:false,plugins:[{fn:d,cfg:{duration:0.25}}]})}}var b='<div class="ugccmt-msg-info-pointer"></div><div class="ugccmt-msg-info">'+c+"</div>";this.hideErrorOverlay();this.oOverlayContainer.info.render(a.one("#ugccmt-container-b")||a.one("#ugccmt-container"));this.oOverlayContainer.info.set("bodyContent",'<div class="custom-overlay">'+b+"</div>");this.oOverlayContainer.info.set("align",{node:e,points:[a.WidgetPositionAlign.TC,a.WidgetPositionAlign.BC]});this.oOverlayContainer.info.show()},hideInfoOverlay:function(){if(typeof this.oOverlayContainer.info!="undefined"){this.oOverlayContainer.info.hide()}},showErrorOverlay:function(f,d,b){if(typeof this.oOverlayContainer.error=="undefined"){if(a.UA.ie){this.oOverlayContainer.error=new a.Overlay({visible:false,zIndex:1000,constrain:true})}else{var e=this.getAnimPlugin();this.oOverlayContainer.error=new a.Overlay({visible:false,zIndex:1000,constrain:true,plugins:[{fn:e,cfg:{duration:0.25}}]})}}if(b!==null&&b!==""&&typeof b!="undefined"){d=d+"&nbsp;"+b+"&nbsp;"}var c=this;this.hideErrorOverlay();this.oOverlayContainer.error.render(a.one("#ugccmt-container-b")||a.one("#ugccmt-container"));this.oOverlayContainer.error.set("bodyContent",'<div class="custom-overlay"><div class="ugccmt-error-pointer"></div><div class="ugccmt-error"><span class="ugccmt-sprite_bg ugccmt-sprite_img ugccmt-warning-icon"> </span><span>'+d+"</span></div></div>");this.oOverlayContainer.error.set("align",{node:f,points:[a.WidgetPositionAlign.BR,a.WidgetPositionAlign.TC]});this.oOverlayContainer.error.show();this.oHideErrorOverlay=window.setTimeout(function(){c.hideErrorOverlay()},10000)},hideErrorOverlay:function(){if(typeof this.oOverlayContainer.error!="undefined"){this.oOverlayContainer.error.hide()}if(!a.Lang.isNull(this.oHideErrorOverlay)){delete this.oHideErrorOverlay}},commentsOverlayMessage:function(c,e){var b={align:{node:c,points:["tr","br"]},bodyContent:'<div id="ugccmt-overlay-login-rate" class="ugccmt-overlay-login">'+((e)?"<h3>"+e+"</h3>":"")+'<ul><li><a rel="ignore" href="#" aria-checked="false" id="ugccmt-login_yahoo" class="ugccmt-login"><div class="img_yahoo"><span dir="ltr">'+this.oL10n.SIGNIN_YAHOO+'</span></div></a></li><li><a rel="ignore" href="#" aria-checked="false" id="ugccmt-login_facebook" class="ugccmt-login"><div class="img_facebook"><span>'+this.oL10n.SIGNIN_FACEBOOK+'</span></div></a></li><li><a rel="ignore" href="#" aria-checked="false" id="ugccmt-login_google" class="ugccmt-login"><div class="img_google"><span>'+this.oL10n.SIGNIN_GOOGLE+"</span></div></a></li></ul></div>"};if(!this.oOverlayContainer.logout){if(a.UA.ie){this.oOverlayContainer.logout=new a.Overlay({visible:false,width:"120px",zIndex:1000,constrain:true})}else{var d=this.getAnimPlugin();this.oOverlayContainer.logout=new a.Overlay({visible:false,width:"120px",zIndex:1000,constrain:true,plugins:[{fn:d,cfg:{duration:0.25}}]})}}this.oOverlayContainer.logout.render(a.one("#ugccmt-container-b")||a.one("#ugccmt-container"));this.oOverlayContainer.logout.set("bodyContent",'<div class="custom-overlay">'+b.bodyContent+"</div>");this.oOverlayContainer.logout.set("align",b.align);this.oOverlayContainer.logout.show();if(a.one("#ugccmt-login_yahoo")){a.one("#ugccmt-login_yahoo").focus()}},getAnimPlugin:function(){function b(c){b.superclass.constructor.apply(this,arguments)}b.NS="fx";b.NAME="animPlugin";b.ATTRS={duration:{value:0.25},animVisible:{valueFn:function(){var d=this.get("host");var c=d.get("boundingBox");var e=new a.Anim({node:c,to:{opacity:1},duration:this.get("duration")});if(!d.get("visible")){c.setStyle("opacity",0)}e.on("destroy",function(){if(a.UA.ie){this.get("node").setStyle("opacity",1)}else{this.get("node").setStyle("opacity","")}});return e}},animHidden:{valueFn:function(){return new a.Anim({node:this.get("host").get("boundingBox"),to:{opacity:0},duration:this.get("duration")})}}};a.extend(b,a.Plugin.Base,{initializer:function(c){this._bindAnimVisible();this._bindAnimHidden();this.after("animVisibleChange",this._bindAnimVisible);this.after("animHiddenChange",this._bindAnimHidden);this.doBefore("_uiSetVisible",this._uiAnimSetVisible)},destructor:function(){this.get("animVisible").destroy();this.get("animHidden").destroy()},_uiAnimSetVisible:function(c){if(this.get("host").get("rendered")){if(c){this.get("animHidden").stop();this.get("animVisible").run()}else{this.get("animVisible").stop();this.get("animHidden").run()}return new a.Do.Prevent("AnimPlugin prevented default show/hide")}},_uiSetVisible:function(d){var c=this.get("host");var e=c.getClassName("hidden");if(!d){c.get("boundingBox").addClass(e)}else{c.get("boundingBox").removeClass(e)}},_bindAnimVisible:function(){var c=this.get("animVisible");c.on("start",a.bind(function(){this._uiSetVisible(true)},this))},_bindAnimHidden:function(){var c=this.get("animHidden");c.after("end",a.bind(function(){this._uiSetVisible(false)},this))}});return b},getUserMarkup:function(){var c="";if(this.sUserNickname!==""){c='<strong class="ugccmt-nick">'+this.sUserNickname+"</strong>"}if(typeof this.oUserLocation.city!="undefined"){var b="";if(this.oUserLocation.is_sharelocation===true){b='checked="checked"'}c+='<span class="ugccmt-loc">';c+=' <span class="ugccmt-bull">&nbsp;&#8226;&nbsp;</span>';c+=' <span class=" ugccmt-change-ckin-location">';c+=' <a class="loc-link" href="#">'+this.oUserLocation.city+", "+this.oUserLocation.ctry+"</a>";c+=' <a class="yom-button" href="#Change location" rel="nofollow" role="button" aria-describedby="location widget" title="Location Options"><span class="arrow arrow-down ugccmt-lw">&nbsp;</span></a>';c+=" </span>";c+=' <span class="ugccmt-bull">&nbsp;&#8226;&nbsp;</span> <input class="loc-share" id="loc-share" type="checkbox" '+b+'><label class="loc-share" for="loc-share">'+this.oL10n.SHOW_LOCATION+"</label>";c+=' <a class="loc-help" href="#" role="button" title="Location Help">Help</a>';c+="</span>"}c+='<a class="ugccmt-guideline" rel="nofollow" href="'+this.comment_guideline_url+'" target="_blank">'+this.oL10n.COMMENT_GUIDELINES+"</a>";return c},onClickCommentLocation:function(e){var d=e.one("span").getAttribute("class");var c=e.one("span").getContent();var b={city:c,woeid:d};this.sFltrCity=c;var f="c_fl";if(a.one(".ugccmt-location-cloud")!==null&&a.one(".ugccmt-location-cloud").contains(e)){f="t_fl"}this.ult_track(f,e);this.sCurrentFltrBy=a.one(".ugccmt-tab-fltr .selected").get("id").split("-")[2];this._render_LocationTab(b);this.fltrCommentsHandler(a.one("#ugccmt-fltr-loc"))},onClickCommentUserClose:function(c){var b=c.get("parentNode");if(b.hasClass("selected")){this.fltrCommentsHandler(a.one("#ugccmt-fltr-all"))}b.remove();this.markTcBlockActive()},onClickCommentTopicClose:function(c){var b=c.get("parentNode");if(b.hasClass("selected")){this.fltrCommentsHandler(a.one("#ugccmt-fltr-all"))}b.remove();this.markTcBlockActive()},onClickCommentLocationClose:function(c){var b=c.get("parentNode");if(b.hasClass("selected")){this.fltrCommentsHandler(a.one("#ugccmt-fltr-all"))}b.remove()},onClickCommentLocationCloseTopics:function(c){var b=c.get("parentNode");b.remove()},_render_CommentStream:function(b){var c=a.one("#ugccmt-comments");c.setContent(b.markup);if(typeof(b.more_url)!="undefined"){this._render_MoreLink({more_url:b.more_url,more_lbl:b.pagination_msg})}this._render_Total({total:b.total,total_msg:b.total_msg});this.renderReplyLinks("ugccmt-container");this.renderRateButton("ugccmt-container");this.clearCommentContentBuffer();this.renderEllipSizedBox("ugccmt-container");this.disable_post_rate_btns();if(!a.Lang.isNull(a.one("#ugccmt-post-frm-container"))){a.one("#ugccmt-post-frm-container").setStyle("display","none");a.one("#ugccmt-post-frm-container").setStyle("display","")}},_render_UserCmtTab:function(b){if(b.uid==this.user_guid){var g=a.one("#ugccmt-fltr-my");if(g.hasClass("selected")){return}this.ult_track("f_my",g);this.fltrCommentsHandler(g)}else{var g=a.one("#ugccmt-fltr-usr");if(a.Lang.isNull(g)){g=a.Node.create('<li id="ugccmt-fltr-usr" class="ugccmt-fltr"><a href="#" rel="nofollow" id="usr_'+b.uid+'" class="ugccmt-fltr-link ugccmt-fltr-usr">'+b.name+'</a><span class="ugccmt-tab-spacer">&nbsp;</span><a class="ugccmt-sprite_bg ugccmt-fltr-usr-close" href="#" title="Close">Close</a></li>');a.one(".ugccmt-tab-fltr").append(g);this.ult_track("f_usr",g);this.fltrCommentsHandler(g,b)}else{if(g.hasClass("selected")&&this.currentUserUid==b.uid){return true}var c=a.one(".ugccmt-fltr-usr");c.setContent(b.name);this.ult_track("f_usr",g);this.fltrCommentsHandler(g,b)}this.currentUserUid=b.uid}var f=a.one("body");if(f.get("scrollTop")===0){var e=g.getXY();window.scrollTo(e[0],e[1])}var d=new a.Anim({node:f,to:{scroll:function(h){return[0,g.get("offsetTop")]}},easing:a.Easing.easeOut});d.run()},_render_TopicTab:function(f){var g=a.one("#ugccmt-fltr-toc");var i=this;if(a.Lang.isNull(g)){g=a.Node.create('<li id="ugccmt-fltr-toc" class="ugccmt-fltr"><a href="#" rel="nofollow" id="toc_'+f.cid+'" class="ugccmt-fltr-link ugccmt-fltr-toc">Topics</a><span class="ugccmt-change-fltr-location">&nbsp;</span><a class="ugccmt-sprite_bg ugccmt-fltr-toc-close" href="#">Close</a></li>');a.one(".ugccmt-tab-fltr").append(g);this.fltrCommentsHandler(a.one("#ugccmt-fltr-toc"))}else{var b=a.one(".ugccmt-fltr-toc");var e=b.get("id");if(e!="toc_"+f.cid){b.set("id","toc_"+f.cid);this.fltrCommentsHandler(a.one("#ugccmt-fltr-toc"))}}var h=a.one("#ugccmt-fltr-loc");if((!a.Lang.isNull(h))&&(!a.Lang.isNull(h.one(".ugccmt-fltr-loc-close")))){h.all(".ugccmt-fltr-loc-close").each(function(k){i.onClickCommentLocationCloseTopics(k)})}var c=a.one("body");if(c.get("scrollTop")===0){var j=g.getXY();window.scrollTo(j[0],j[1])}var d=new a.Anim({node:c,to:{scroll:function(k){return[0,g.get("offsetTop")]}},easing:a.Easing.easeOut});d.run()},_render_LocationTab:function(d){var c=a.one("#ugccmt-fltr-loc");var e=a.one("#ugccmt-fltr-toc");if((!a.Lang.isNull(e))&&(!a.Lang.isNull(e.one(".ugccmt-fltr-toc-close")))){this.onClickCommentTopicClose(e.one(".ugccmt-fltr-toc-close"));this.markTcBlockActive()}if(a.Lang.isNull(c)){c=a.Node.create('<li id="ugccmt-fltr-loc" class="ugccmt-fltr"><a href="#" rel="nofollow" id="loc_'+d.woeid+'" class="ugccmt-fltr-link ugccmt-fltr-loc-geo">'+d.city+'</a><span class="ugccmt-change-fltr-location"><a class="yom-button" href="#Change location" rel="nofollow" role="button" aria-describedby="location widget" title="Location Options"><span class="arrow arrow-down ugccmt-lw">&nbsp;</span></a></span><a class="ugccmt-sprite_bg ugccmt-fltr-loc-close" href="#">Close</a></li>');a.one(".ugccmt-tab-fltr").append(c);this.initLocWidget(a.one("#ugccmt-fltr-loc"))}else{var b=a.one(".ugccmt-fltr-loc-geo");b.setContent(d.city);b.set("id","loc_"+d.woeid)}var h=a.one("body");if(h.get("scrollTop")===0){var g=c.getXY();window.scrollTo(g[0],g[1])}var f=new a.Anim({node:h,to:{scroll:function(i){return[0,c.get("offsetTop")]}},easing:a.Easing.easeOut});f.run()},initLocWidget:function(b){if(typeof b==="undefined"||!b){return}var h=b.one(".ugccmt-lw");if(!h){return}if(""===h.getAttribute("id")){h.setAttribute("id",a.guid("ugccmt_lw"))}var d=("ugccmt-fltr-loc"===b.getAttribute("id"))?b:b.one(".ugccmt-change-ckin-location");if(d){var c=d.one(".loc-link")||d.one(".ugccmt-fltr-link");var i=d.one(".yom-button");if(c){c.on("click",function(j){j.halt(true);h.simulate("click")})}if(i){i.on("click",function(j){j.halt(true)})}}var g={divID:h.getAttribute("id"),appID:"universal_location_widget__v2",ctx:this.oLWconfig.widgetContext,callback:this.onSelectLocation(),crumb:this.oLWconfig.crumbVal,upapiExtracted:{curLocObj:(""===this.oLWconfig.curLocObj)?null:this.oLWconfig.curLocObj,defaultLoc:(""===this.oLWconfig.defLocObj)?null:this.oLWconfig.defLocObj},placeFinderGflags:true,customInput:false};var e=new LocdropLocationPicker(g);function f(j){e.setPendingYrbCall(false);e.setYrbContainer(j)}e.init()},getLocale:function(b){var d=a.one("html").get("lang");if(b=="region"){var c=d.match(/[A-Z]+$/);if(!a.Lang.isNull(c)&&typeof c[0]!="undefined"){return c[0]}else{return""}}if(b=="lang"){return d}},onSelectLocation:function(){var b=this;return function(d){var f=null;if(d instanceof LocdropLocationPicker){f=a.one("#"+d.id)}if(!f){return}if(f.ancestor("#ugccmt-fltr-loc")){var c=a.one(".ugccmt-fltr-loc-geo");c.setContent(d.loc.city+", "+d.loc.ctry);c.set("id","loc_"+d.loc.woe);b.sFltrCity=d.loc.city+", "+d.loc.ctry;b.ult_track("f_loc",f);b.fltrCommentsHandler(a.one("#ugccmt-fltr-loc"))}else{b.oUserLocation.city=d.loc.city;b.oUserLocation.ctry=d.loc.ctry;b.oUserLocation.woe=d.loc.woe;b.oUserLocation.lat=d.loc.lat;b.oUserLocation.lon=d.loc.lon;b.oUserLocation.is_checkin=false;a.all(".loc-link").each(function(e){e.setContent(d.loc.city+", "+d.loc.ctry)});a.all(".loc-share").each(function(e){e.set("checked",true)});b.ult_track("c_cl",f)}}},_reset_FilterTabs:function(c){var b=a.one("#ugccmt-sort-list");var d;a.all(".ugccmt-tab-fltr li").each(function(e){e.removeClass("selected");e.replaceClass("ugccmt-fltr-disabled","ugccmt-fltr")});if(c=="ugccmt-fltr-my"){d=a.one("#ugccmt-fltr-my");b.setStyle("display","none")}else{if(c=="ugccmt-fltr-loc"){d=a.one("#ugccmt-fltr-loc");b.setStyle("display","none")}else{if(c=="ugccmt-fltr-toc"){d=a.one("#ugccmt-fltr-toc");b.setStyle("display","none")}else{if(c=="ugccmt-fltr-usr"){d=a.one("#ugccmt-fltr-usr");b.setStyle("display","none")}else{d=a.one("#ugccmt-fltr-all");b.setStyle("display","");this.renderSortList(this.sCurrentSortBy)}}}}if(!a.Lang.isNull(d)){d.addClass("selected");d.replaceClass("ugccmt-fltr","ugccmt-fltr-disabled")}},_render_MoreLink:function(f){var e="";if(typeof f.id_suffix!="undefined"){e=f.id_suffix}var b=a.one("#ugccmt-view-more-container"+e);if(a.Lang.isNull(b)&&this.isUserCommentsTab()){var c='<div class="ugccmt-navigation" id="ugccmt-view-more-container"></div>';a.one("#ugccmt-comments").insert(c,"after");b=a.one("#ugccmt-view-more-container")}if(!a.Lang.isNull(b)){var d="";if(f.more_url!==""){d='<a id="ugccmt-view-more'+e+'" class="ugccmt-view-more" href="#" data-href="'+f.more_url+'">'+f.more_lbl+"</a>"}b.setContent(d)}},_getTotalCommentCount:function(){var b=(a.one("#ugccmt-title"))?a.one("#ugccmt-title"):a.one("#ugccmt-total");var e=0;if(!a.Lang.isNull(b)){e="";var d=b.get("className").split(" ")[1];if(typeof d!="undefined"){var c=d.split("_");if(typeof c[1]!="undefined"){e=parseInt(c[1],10)}}}return e},_render_Total:function(e){var c=(a.one("#ugccmt-title"))?a.one("#ugccmt-title"):a.one("#ugccmt-total");if(!a.Lang.isNull(c)){var d=e.total_msg;var g=parseInt(e.total,10);var f=c.get("className").split(" ")[1];var b="ugcmt-total-no_"+g;c.replaceClass(f,b);c.setContent(d)}},_isReply:function(f){var c=false;var b="";if(this.isUserCommentsTab()){if(f.ancestor(".ugccmt-replies")){c=true;var d=this.getSelfInfo(f);b=d.comment_id}}else{var e=f.ancestor(".ugccmt-replies");if(!a.Lang.isNull(e)){c=true;b=e.get("id").split("_")[1]}}return[c,b]},_isBubbleMode:function(d){var b=false;var c=a.one("#ugccmt-container-b");if(!a.Lang.isNull(c)&&c.contains(d)){b=true}return b},_showHiddenComment:function(h){this.ult_track("c_unhide",h);var d=h.get("id").split("|");var f=d[0];var c=d[1];var i=d[2];if(this.user_guid!==""){c=(c=="blue_thumb_up_lout")?"blue_thumb_up":c;i=(i=="blue_thumb_down_lout")?"blue_thumb_down":i}var b=a.one("#ugccmt-rate-tu_"+f);if(!a.Lang.isNull(b)){b.replaceClass("gray_thumb_up",c)}var g=a.one("#ugccmt-rate-td_"+f);if(!a.Lang.isNull(g)){g.replaceClass("gray_thumb_down",i)}var e=h.ancestor(".ugccmt-info");e.one("blockquote.ugccmt-hide").replaceClass("ugccmt-hide","ugccmt-show");if(e.one("a.ugccmt-hide")!=null){e.one("a.ugccmt-hide").replaceClass("ugccmt-hide","ugccmt-show")}h.get("parentNode").remove()},markRemoteTcBlockActive:function(c){if(!a.Lang.isNull(c)){var d={};var b;d.cid=parseInt(c.get("id").split("_")[1],10)+1;if(d.cid===1){b=/ugccmt-topic1/g}else{if(d.cid===2){b=/ugccmt-topic2/g}else{if(d.cid===3){b=/ugccmt-topic3/g}else{if(d.cid===4){b=/ugccmt-topic4/g}else{if(d.cid===5){b=/ugccmt-topic5/g}}}}}a.all("#ugccmt-container .ugccmt-topic-cluster a").each(function(e){if(e.hasClass("ugccmt-link-active")){e.removeClass("ugccmt-link-active");e.get("parentNode").removeClass("ugccmt-topic-active")}else{if(e.get("parentNode").get("className").match(b)){e.addClass("ugccmt-link-active");e.get("parentNode").addClass("ugccmt-topic-active")}}})}},markTcBlockActive:function(b){if(b!==null&&typeof b!="undefined"&&(!b.hasClass("ugccmt-link-active"))){a.all("#ugccmt-container .ugccmt-topic-cluster a").each(function(d){if(d.hasClass("ugccmt-link-active")){d.removeClass("ugccmt-link-active");d.get("parentNode").removeClass("ugccmt-topic-active")}});var c={};b.get("parentNode").addClass("ugccmt-topic-active");b.addClass("ugccmt-link-active");if(b.get("className").match(/ugccmt-link-toc1/g)){c.cid="0"}else{if(b.get("className").match(/ugccmt-link-toc2/g)){c.cid="1"}else{if(b.get("className").match(/ugccmt-link-toc3/g)){c.cid="2"}else{if(b.get("className").match(/ugccmt-link-toc4/g)){c.cid="3"}else{if(b.get("className").match(/ugccmt-link-toc5/g)){c.cid="4"}}}}}this._render_TopicTab(c);return true}else{if(!a.Lang.isNull(a.one("#ugccmt-container .ugccmt-topic-cluster a"))){a.all("#ugccmt-container .ugccmt-topic-cluster a").each(function(d){if(d.hasClass("ugccmt-link-active")){d.removeClass("ugccmt-link-active");d.get("parentNode").removeClass("ugccmt-topic-active")}});return false}}},_toggleLocationCloud:function(){var c=a.one("#ugccmt-container .ugccmt-location-cloud-toggle");var b=a.one("#ugccmt-container .ugccmt-location-cloud");var e=a.one("#ugccmt-container .ugccmt-topic-cloud-toggle");var d=a.one("#ugccmt-container .ugccmt-topic-cluster");if((!a.Lang.isNull(c))&&(!a.Lang.isNull(b))){if(c.hasClass("selected-loc")){c.removeClass("selected-loc");b.addClass("ugccmt-hidden")}else{c.addClass("selected-loc");b.removeClass("ugccmt-hidden");if((!a.Lang.isNull(e))&&(!a.Lang.isNull(d))){if(e.hasClass("selected-toc")){e.removeClass("selected-toc");d.addClass("ugccmt-hidden")}}}}},_toggleTopicCloud:function(){var e=a.one("#ugccmt-container .ugccmt-topic-cloud-toggle");var d=a.one("#ugccmt-container .ugccmt-topic-cluster");var c=a.one("#ugccmt-container .ugccmt-location-cloud-toggle");var b=a.one("#ugccmt-container .ugccmt-location-cloud");if((!a.Lang.isNull(e))&&(!a.Lang.isNull(d))){if(e.hasClass("selected-toc")){e.removeClass("selected-toc");d.addClass("ugccmt-hidden")}else{e.addClass("selected-toc");d.removeClass("ugccmt-hidden");if((!a.Lang.isNull(c))&&(!a.Lang.isNull(b))){if(c.hasClass("selected-loc")){c.removeClass("selected-loc");b.addClass("ugccmt-hidden")}}}}},_setupStartConversation:function(){var d=this,b=10,c;if(typeof YAHOO.Media.SocialConversation!="undefined"){d.bConversations=true;d._renderStartConversation()}else{c=a.later(1000,this,function(){if(typeof YAHOO.Media.SocialConversation!="undefined"){d.bConversations=true;d._renderStartConversation();b=0}if(--b<=0){c.cancel();c=null}},null,true)}},_renderStartConversation:function(){var b=this;a.all("#ugccmt-container .ugccmt-post-button-wrapper").each(function(e){var d=e.get("parentNode").one(".ugccmt-start-conv");if(d===null){var g={MSG_START_CONVERSATION:b.oL10n.MSG_START_CONVERSATION,NEW_LABLE:b.oL10n.NEW_LABLE};var f=a.substitute(b.conv_link_templates.start_conversation,g);var c=a.Node.create(f);e.insert(c,"before")}})},_onStartConversationClick:function(){try{YUI().use("event-custom",function(c){c.Global.fire("media-social-conversation:start")})}catch(b){}},getContextInfo:function(i){var h="",c="";if(this.isUserCommentsTab()){var e=this.getSelfInfo(i);h=e.context_id;var g=h&&a.one("#ugccmt-comments .ugccmt_context_data_"+h);if(g){try{var b=a.JSON.parse(g.getContent());c=decodeURIComponent(b.context_url)}catch(f){}}}else{h=this.context_id;c=this.context_url}var d={context_id:h,context_url:c};return d},isUserCommentsTab:function(){var b=false;if(!a.Lang.isNull(a.one("#ugccmt-fltr-usr"))&&a.one("#ugccmt-fltr-usr").hasClass("selected")){b=true}if(!a.Lang.isNull(a.one("#ugccmt-fltr-my"))&&a.one("#ugccmt-fltr-my").hasClass("selected")){b=true}return b},getSelfInfo:function(h,f){var e={context_id:"",comment_id:"",reply_id:""};if(typeof(h)=="undefined"||h==null||h==false){a.io(this.aXHR.ERR_LOG+"COMMENTS-ERR-EmptyTarget_in_getSelfInfo");return e}if(this.isUserCommentsTab()||f){var c=h&&h.ancestor("li.ugccmt-cmt-item");var d=c&&c.one(".ugccmt-self-uri");var g=d&&d.getContent().split("/");e.context_id=g[3]||"";e.comment_id=g[5]||"";e.reply_id=g[7]||"";if(e.reply_id!=""){if(e.reply_id.length!=67){var b=escape("selfInfo.context_id="+e.context_id+", selfInfo.reply_id="+e.reply_id+",URI is: "+window.location.href);a.io(this.aXHR.ERR_LOG+"COMMENTS-ERR-TRUNCATED-REPLY-ID_in_getSelfInfo&err_response_body="+b)}}}return e},eoConfirm:function(f){if(f.hasClass("eo-confirm")){f.hide();var b='<span class="eo-confirm-container"><span>'+this.oL10n.ARE_YOU_SURE+'</span> <a href="#" class="eo-confirm-yes">'+this.oL10n.YES+'</a> <a href="#" class="eo-confirm-no">'+this.oL10n.NO+"</a></span>";var d=a.Node.create(b);f.insert(d,"after")}else{var c=f.ancestor(".eo-confirm-container");var e=c.previous("a");c.remove();e.show();if(f.hasClass("eo-confirm-yes")){this.eoAction(e)}}},eoAction:function(e){var i=this;if(!this.isUserCommentsTab()){var h=this.getSelfInfo(e,true);var f="eo"+h.comment_id+h.reply_id}else{var f="eo"+e.getAttribute("href")}this.showPreloader(f,"ugccmt-abuse-preloader",e,"append");function j(q,p,l){i.removePreloader(f);try{var m=a.JSON.parse(p.responseText);if(typeof m.rcrumb!="undefined"){i.ycrumb=m.rcrumb;i.eoAction(e)}if(m.status&&m.status===true){if(e.hasClass("eo-delete")){e.ancestor(".ugccmt-comment").ancestor("li").setContent(this.oL10n.COMMENT_REMOVED)}else{if(e.hasClass("eo-feature")){e.removeClass("eo-feature").addClass("eo-unfeature");e.setContent(i.oL10n.UNFEATURE);var n='<div class="ugccmt-featured"><span class="ugccmt-featured-comment">'+this.oL10n.FEATURED+"</span></div>";e.ancestor(".ugccmt-comment").one(".ugccmt-rate").insert(n,"after")}else{if(e.hasClass("eo-unfeature")){e.removeClass("eo-unfeature").addClass("eo-feature");e.setContent(i.oL10n.FEATURE);e.ancestor(".ugccmt-comment").one(".ugccmt-featured").remove()}else{if(e.hasClass("eo-revoke-badge")){i.showInfoOverlay(e,m.info.message);setTimeout(function(){i.hideInfoOverlay()},5000)}}}}}else{i.showErrorOverlay(e,m.info.message)}}catch(k){i.showErrorOverlay(e,i.oL10n.SERVER_ERROR)}}function d(m,l,k){i.showErrorOverlay(e,i.oL10n.REQUEST_FAILED)}var b="",g=true,c={};if(e.hasClass("eo-delete")){b=h.reply_id==""?this.aXHR.REPORT_ABUSE_COMMENT:this.aXHR.REPORT_ABUSE_REPLY}else{if(e.hasClass("eo-feature")){b=h.reply_id==""?this.aXHR.RATE_COMMENT:this.aXHR.RATE_REPLY;c.rating_value="thumbsUp"}else{if(e.hasClass("eo-unfeature")){b=h.reply_id==""?this.aXHR.RATE_COMMENT:this.aXHR.RATE_REPLY;c.rating_value="thumbsDown"}else{if(e.hasClass("eo-revoke-badge")){b=this.aXHR.REVOKE_BADGE;c.guid=e.getAttribute("href");g=false}}}}if(g){b+="&context_id="+h.context_id;b+="&comment_id="+h.comment_id;b+="&reply_id="+h.reply_id}b+="&baseurl="+encodeURIComponent(h.context_url);c.ycrumb=this.ycrumb;c.userType="communityManager";a.io(b,{on:{success:j,failure:d},method:"POST",data:c,context:this,"arguments":{argument:e}})},removeElementInArray:function(d,c){var b=a.Array.indexOf(d,c);if(b>=0){d.splice(b,1)}},cleanupYWACookies:function(c){var b=[],l=[],g=[],f;if("0"===this.ywaWhitelist||"news.yahoo.com"!==location.hostname){return}b=c.split(",");l=document.cookie.split(";");for(var e=0,d=l.length;e<d;e++){if(l[e].indexOf("fpc1000")>-1){f=l[e].match(/fpc1000(.+?)=/)[1];g[g.length]=f;for(var k=0,h=b.length;k<h;k++){if(f===b[k]){g.pop()}}}}for(var e=0,d=g.length;e<d;e++){a.Cookie.remove("fpc1000"+g[e])}}}},"0.0.1",{requires:["io","json","querystring","cookie","substitute","node","event","anim","io-base","json-parse","substitute","overlay","dd-plugin","dump","plugin","media-tracking"]});